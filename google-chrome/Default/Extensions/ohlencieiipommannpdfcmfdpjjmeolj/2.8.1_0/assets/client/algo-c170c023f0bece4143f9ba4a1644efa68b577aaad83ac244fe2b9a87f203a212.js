function MySimpleMap(){this.size=0,this.store={}}function memoize(e){var t={};return function(){var n=arguments[0];if(t[n])return t[n];var a=e.apply(this,arguments);return t[n]=a,a}}function copyDataset(e,t){for(var n in t.dataset)e.dataset[n]=t.dataset[n]}function forEachNodeChild(e,t){if(e)for(var n=Array.prototype.slice.call(e.childNodes),a=0,i=n.length;a<i;a++)t(n[a])}function toBase64URL(e,t){if(!pfData.userSettings.encodeImages||e.startsWith("data:"))return t(e);var n=new XMLHttpRequest;n.onload=function(){var e=new FileReader;e.onloadend=function(){t(e.result)},e.readAsDataURL(n.response)},n.onerror=function(){t(e)},n.open("GET",e),n.responseType="blob",n.send()}Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(e){for(var t=(this.document||this.ownerDocument).querySelectorAll(e),n=t.length;--n>=0&&t.item(n)!==this;);return n>-1}),String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return t=!t||t<0?0:+t,this.substring(t,t+e.length)===e});var logger=function(){var e={init:function(t){$.each(["log","error","time","timeEnd"],function(n,a){t.config.enableLog?e[a]=Function.prototype.bind.call(console[a],console):e[a]=$.noop})}};return e}(),commonUtils={hasClass:function(e,t){return e.nodeType===Node.ELEMENT_NODE&&(e.classList?e.classList.contains(t):(e.getAttribute("class")||"").split(/\s/).indexOf(t)>=0)},addClassTo:function(e,t){e.nodeType===Node.ELEMENT_NODE&&(commonUtils.hasClass(e,t)||(e.classList?e.classList.add(t):e.className=(e.className||"")+" "+t))},removeClassFrom:function(e,t){if(e.nodeType===Node.ELEMENT_NODE&&commonUtils.hasClass(e,t))if(e.classList)e.classList.remove(t);else{var n=(e.getAttribute("class")||"").split(" "),a=n.indexOf(t);a>=0&&n.splice(a,1),e.setAttribute("class",n.join(" "))}},getImageWidth:function(e,t){e.jquery&&(e=e[0]);var n=null;if(t){var a=e.getAttribute("pf-data-width");a&&(n=parseInt(a,10))}else e.getAttribute("data-pf_rect_width")&&(n=parseInt(e.getAttribute("data-pf_rect_width"),10));return(null===n||0===n||"number"!=typeof n||isNaN(n))&&(n=e.getBoundingClientRect().width),n},getImageHeight:function(e,t){e.jquery&&(e=e[0]);var n=null;if(t){var a=e.getAttribute("pf-data-height");a&&(n=parseInt(a,10))}else e.getAttribute("data-pf_rect_height")&&(n=parseInt(e.getAttribute("data-pf_rect_height"),10));return(null===n||0===n||"number"!=typeof n||isNaN(n))&&(n=e.getBoundingClientRect().height),n},MAX_SVG_SIZE:200,MAX_SVG_ICON_SIZE:21,ICON_REGEXP:/icon/i,svgMaxValue:function(e){return this.ICON_REGEXP.test(e.getAttribute("class")||"")?this.MAX_SVG_ICON_SIZE:this.MAX_SVG_SIZE},svgViewBox:function(e){var t=e.getAttribute("viewBox");if(t){var n=t.split(" ");if(4===n.length)return{width:parseInt(n[2],10),height:parseInt(n[3],10)}}return{}},INFINITY:1e6,getSvgImageWidth:function(e,t){var n=this.getImageWidth(e,t)||this.INFINITY,a=this.svgMaxValue(e),i=this.svgViewBox(e).width||this.INFINITY;return Math.min(n,a,i)},getSvgImageHeight:function(e,t){var n=this.getImageHeight(e,t),a=this.svgMaxValue(e),i=this.svgViewBox(e).height||this.INFINITY;return Math.min(n,a,i)},getTopWrapper:function(e){var t=e.parentNode;return t.childNodes.length>1?e:this.getTopWrapper(t)},isDeletableElement:function(){return function(e){return!commonUtils.hasClass(e,"non-delete")&&(e.matches("small, footer, header, aside, details, dialog, figure, nav, summary, twitter-widget, p, img, blockquote, h1, h2, h3, h4, h5, h6, ol, ul, li, a, table, td, pre, span, code, dl, dt, dd, hr, div.pf-caption, video, figcaption, data")||$(e).find("*:visible").length<=15)}}(),resizeImageCssClass:function(e){return"pf-size-"+e.replace("-size","").replace("-images","")},addCSS:function(e,t,n){var a=n?"body":"head",i=t.getElementsByTagName(a)[0],r=t.createElement("style");r.type="text/css",r.setAttribute("name","pf-style"),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(t.createTextNode(e)),i.appendChild(r)},createIframe:function(e){var t=e.createElement("iframe");return t.frameBorder="0",t.allowTransparency="true",t},loadHtmlInIframe:function(e,t,n){var a,i;try{i=t.contentWindow.document}catch(n){a=e.domain,t.src="javascript:var d=document.open();d.domain='"+a+"';void(0);",i=t.contentWindow.document}i.write(n),i.close()}},analytics=function(){return{sendEvent:function(e,t,n){messageBus.postMessage("core","PfGaEvent",{category:e,action:t,label:n})}}}(),exTracker=function(){function e(){return"production"===h.environment}function t(){return"development"===h.environment}function n(){return!!c.Raven}function a(){try{c.frames["pf-core"]&&c.frames["pf-core"].document&&(c=c.frames["pf-core"],d=c.document)}catch(e){}}function i(){if(g)return!0;if(g=!0,a(),null===d)return!1;var e=d.createElement("script"),t=d.getElementsByTagName("script")[0];e.src=this.config.urls.js.raven,t.parentNode.appendChild(e),r()}function r(){if(!n())return setTimeout(r,100);s(),o()}function o(){for(var e=0,t=m.length;e<t;e++){var n=m[e];l(n.err,n.opts)}}function s(){var e={dataCallback:function(e){try{var t=e.stacktrace.frames[0];t.filename.match(p)&&"onload"!==t["function"]||e.stacktrace.frames.shift()}catch(e){}return e},shouldSendCallback:function(e){return!!(e&&e.extra&&e.extra.file)},release:f};c.Raven.config(h.hosts.ravenDsn,e).install()}function l(t,n){n=n?{file:n.file}:{file:"printfriendly.js"},n.usingBM=h.usingBM,n.url=h.urls.page,e()&&c.Raven.captureException(t,{extra:n})}var c=window.top,d=null,g=!1,p=/d3nekkt1lmmhms|printfriendly\.com|printnicer\.com|algo\.js|printfriendly\.js|core\.js/,m=[],u=[],h={},f=null;return{init:function(e,t){h=e.config,f=e.version,"production"!==e.config.environment||e.onServer?t():Raven.context(t)},log:function(e,a){t()&&(console.error(e),console.error(e.stack)),a=a||{file:"printfriendly.js"};try{n()?l(e,a):(m.push({err:e,opts:a}),i(),u.push(e.name+" : "+e.message),u.push(e.stack))}catch(e){}}}}();MySimpleMap.prototype.get=function(e){return this.store[e]},MySimpleMap.prototype.set=function(e,t){this.store[e]===undefined&&this.size++,this.store[e]=t};var commonScore=function(){function e(e){e=e||{};var t=e.words||new MySimpleMap,n=e.links||new MySimpleMap;return{words:t,links:n,uniqWordsCount:t.size,uniqLinksCount:n.size,tagsCount:e.tagsCount||0,hTagsCount:e.hTagsCount||0,hasContentTag:e.hasContentTag||!1,hasImage:e.hasImage||!1,hasTable:e.hasTable||!1}}function t(t){for(var n=new MySimpleMap,a=sliceWordsService(t),i=0,r=a.length;i<r;i++){var o=a[i];n.set(o,(n.get(o)||0)+1)}return e({words:n})}function n(t){var n=t.match(s),a=new MySimpleMap;return n&&a.set(n[2].toLowerCase(),1),e({links:a})}function a(e,t,n){var a=new MySimpleMap,i=e[n].store,r=t[n].store;for(var o in i)a.set(o,i[o]);for(var s in r)a.set(s,(a.get(s)||0)+r[s]);return a}function i(e,t){e.words=a(e,t,"words"),e.links=a(e,t,"links"),e.uniqLinksCount=e.links.size,e.uniqWordsCount=e.words.size,e.hasContentTag=e.hasContentTag||t.hasContentTag,e.hasImage=e.hasImage||t.hasImage,e.hasTable=e.hasTable||t.hasTable,e.tagsCount+=t.tagsCount,e.hTagsCount+=t.hTagsCount}function r(a){if(a.node.nodeType===Node.TEXT_NODE&&a.node.parentNode&&isContentNodeHelperService(a.node.parentNode))return t(a.node.textContent);var r=mergeChildrenScoreHelperService(a,o,e(),i);switch(r.hasContentTag=r.hasContentTag||a.nameMatches(l),r.hasTable=r.hasTable||a.hasTagName("table"),r.tagsCount++,c.indexOf(a.node.tagName)>=0&&r.hTagsCount++,a.node.nodeName){case"IMG":var s=a.node.getAttribute("alt"),d=a.node.getAttribute("src");r.hasImage=!0,s&&i(r,t(s)),d&&i(r,n(d));break;case"A":var g=a.node.getAttribute("title"),p=a.node.getAttribute("href");g&&i(r,t(g)),p&&i(r,n(p))}return r}var o="common",s=/^https?:\/\/([^\.?]+\.)*([^\.?]+\.[^\.\/?]+)\//,l=/article|main|body|content/i,c=["H1","H2","H3","H4","H5","H6"];return function(e){e.registerScoreFunction(o,r)}}(),doubleBrClassifier=function(){function e(e){return e.node.tagName===n||!(e.scores.common.hasImage||0!==e.scores.common.words.size||!e.isElement()||!e.node.querySelector("br"))}function t(t){if(!t.nameMatches(a)){var n=[],i=null,r=0,o=[];t.forEachChild(function(t,a){o.push(t),e(t)?(0===r&&(i=a),r++):r>=2?(n.push([i,a]),r=0):r=0}),r>=2&&n.push([i,t.children.length-1]);for(var s=0,l=0,c=n.length;l<c;l++){var d=n[l],g=t.tree.createElement("p");g.node.setAttribute("class",a);for(var p=s;p<d[0];p++){var m=o[p];m.node&&m.node.parentNode&&(g.parent||m.parent.replaceChild(g,m),g.appendChild(m))}for(var u=d[0];u<d[1];u++)o[u]&&e(o[u])&&o[u].remove();s=d[1]}}}var n="BR",a="pf-br-replacement";return function(e){e.registerBehaviorFunction(t)}}(),emptyTagsClassifier=function(){function e(e){return e.scores[i]}function t(e){return e=e||{},{skipTag:e.skipTag||!1,parentSkipTag:e.parentSkipTag||!1}}function n(n){if(n.node.nodeType!==Node.ELEMENT_NODE)return t();var a=n.node.tagName.toUpperCase();return t({parentSkipTag:r[a]||n.parent&&e(n.parent).parentSkipTag,skipTag:o[a]})}function a(e){var t=n(e);e.scores[i]=t,e.scores.common.hasImage||0!==e.children.length||t.skipTag||t.parentSkipTag||""!==$.trim(e.node.textContent)||e.node.nodeType===Node.ELEMENT_NODE&&e.node.getAttribute("data-pf-allow-empty")||e.remove()}var i="empty_tags",r={AREA:!0,BASE:!0,COL:!0,COMMAND:!0,EMBED:!0,HR:!0,IMG:!0,INPUT:!0,KEYGEN:!0,LINK:!0,META:!0,PARAM:!0,SOURCE:!0,TRACK:!0,WBR:!0,BR:!0,"TWITTER-WIDGET":!0,IFRAME:!0,PRE:!0,SVG:!0},o={I:!0,SPAN:!0,TD:!0,TH:!0};return function(e){e.registerBehaviorFunction(a)}}(),headerFooterClassifier=function(){function e(e){return e=e||{},{contentPoints:e.contentPoints||0,headerPoints:e.headerPoints||0,footerPoints:e.footerPoints||0}}function t(e){return e.scores[p]}function n(e){var t=e.scores.common.uniqWordsCount;return e.scores.common.hasContentTag&&(t+=y),t}function a(e,t,n){var a=0;return e.hasTagName(t)?a=w.TAG_MATCH:e.hasId(t)?a=w.ID_MATCH:e.hasClass(t)?a=w.CLASS_MATCH:e.nameMatches(n)&&(a=w.PARTIAL_REGEXP_MATCH),a}function i(e){var n=null,a=T;return e.forEachChild(function(e){var i=t(e),r=i.contentPoints-i.footerPoints-i.headerPoints;a<=r&&(n=e,a=r)}),n}function r(e,n){for(var a=null,i=0,r=e.children.length;i<r;i++){var o=e.children[i];if(!(t(o)[n]<=0)){if(a)return null;a=o}}return a}function o(e){return r(e,"headerPoints")}function s(e){return r(e,"footerPoints")}function l(t){return e({headerPoints:a(t,u,m),footerPoints:a(t,h,f),contentPoints:n(t)})}function c(e){var t=e.node.tagName;return e.scores.common.hasTable||b.indexOf(t)>=0}function d(e){return 1===e.scores.common.hTagsCount&&e.scores.common.tagsCount<50}function g(e){if(!(e.node.tagName&&C.indexOf(e.node.tagName)>=0)){var n=t(e),a=e.parent&&t(e.parent)||{};if(n.inArticle=a.inArticle||e.hasTagName("article")||!1,!n.inArticle){var r=i(e),l=o(e),g=s(e);l&&r!==l&&l.scores.common.tagsCount>v&&!c(l)&&!d(l)&&l.remove(),g&&r!==g&&g.scores.common.tagsCount>v&&g.remove()}}}var p="header_footer",m=/head/i,u="header",h="footer",f=/foot/i,y=1e6,v=3,b=["TABLE","THEAD","TBODY","TR","TH"],C=["H1","H2","H3","H4","H5","H6"],T=10,w={TAG_MATCH:4,ID_MATCH:3,CLASS_MATCH:2,PARTIAL_REGEXP_MATCH:1};return function(e){e.registerScoreFunction(p,l),e.registerBehaviorFunction(g)}}(),mustKeepClassifier=function(){function e(e){if(e.nameMatches(t))return void e.keep()}var t=/copyright|delete-no|delete-off|pf-author|print-content|pf-date|pf-title|pf-footer|print-header|print-footer|print-only|print-yes|pf-content/i;return function(t){t.registerMarkFunction(e)}}(),relatedArticlesClassifier=function(){function e(e){return e=e||{},{wordsCount:e.wordsCount||0,insideLinkWordsCount:e.insideLinkWordsCount||0,contentTagsCount:e.contentTagsCount||0,imgTagsCount:e.imgTagsCount||0,aTagsCount:e.aTagsCount||0,hasLongTextNode:e.hasLongTextNode||!1,isDataTag:e.isDataTag||!1,hasIgnoreClasses:e.hasIgnoreClasses||!1,hasInlineLink:e.hasInlineLink||!1,isInlineLink:e.isInlineLink||!1}}function t(e,t){e.wordsCount+=t.wordsCount,e.insideLinkWordsCount+=t.insideLinkWordsCount,e.contentTagsCount+=t.contentTagsCount,e.aTagsCount+=t.aTagsCount,e.imgTagsCount+=t.imgTagsCount,e.hasLongTextNode=e.hasLongTextNode||t.hasLongTextNode,e.hasIgnoreClasses=e.hasIgnoreClasses||t.hasIgnoreClasses,e.hasInlineLink=e.hasInlineLink||t.hasInlineLink}function n(e){var t=e.scores[g];return t.wordsCount!==t.insideLinkWordsCount&&(e.node.nodeType===Node.TEXT_NODE||"inline"===e.node.getAttribute("data-pf_style_display"))}function a(e){var t=!1;return e.forEachChild(function(e){if(e.scores[g].isInlineLink)return t=!0,DomScorerModifier.Intents.BREAK}),t&&!i(e)}function i(e){var t=e.node.textContent;return!!$.trim(t).match(C)}function r(e){for(var t=null,a=e.prev;a;){if($.trim(a.node.textContent)){t=a;break}a=a.prev}return!(!t||!n(t))}function o(e,t){for(var n=null,a=t.getDepthLayer(),i=0,r=0,o=a.length;r<o;r++){var s=a[r];s.node&&(s===t&&(n=i),e.contains(s.node)&&i++)}var l=Math.ceil(i*T),c=Math.floor(i-i*T);return n<=l||n>=c}function s(t,n){if(n=n||0,i(t))return e();var a=t.node.textContent,r=sliceWordsService(a).length;return e({wordsCount:r,hasLongTextNode:r>=u,contentTagsCount:n})}function l(n){if(n.node.nodeType===Node.TEXT_NODE)return s(n);if("P"===n.node.nodeName&&n.node.parentNode&&isContentNodeHelperService(n.node.parentNode))return s(n,1);var i=mergeChildrenScoreHelperService(n,g,e(),t),o=n.node.nodeName;switch(o){case"A":n.node.getAttribute("href")&&"author"!==n.node.getAttribute("rel")&&(i.aTagsCount++,i.insideLinkWordsCount=i.wordsCount,i.hasLongTextNode=!1,i.isInlineLink=r(n));break;case"IMG":i.imgTagsCount++}return i.wordsCount>0&&i.wordsCount>i.insideLinkWordsCount&&isContentNodeHelperService(n.node)&&n.node.parentNode&&n.node.parentNode.childElementCount>1&&i.contentTagsCount++,d[o]&&(i.isDataTag=!0,i.insideLinkWordsCount=0,i.aTagsCount=0,i.imgTagsCount=0),n.nameMatches(b)&&(i.hasIgnoreClasses=!0),i.hasInlineLink=i.hasInlineLink||a(n),i}function c(e,t){var n=e.scores.common;if(!(n.tagsCount>h||n.hasContentTag&&n.uniqWordsCount>f||t.candidate&&t.candidate.contains(e.node)&&!o(t.candidate,e))){var a=e.scores[g];if(a.isDataTag)return DomScorerModifier.Intents.BREAK_TRAVERSAL;if(!(a.hasInlineLink||a.hasIgnoreClasses||a.contentTagsCount>v&&n.uniqWordsCount>f||a.wordsCount<5||a.aTagsCount<2||1===a.imgTagsCount||a.hasLongTextNode)){if(a.imgTagsCount/a.aTagsCount<y){if((a.insideLinkWordsCount/a.wordsCount||0)>=p)return e.remove(),DomScorerModifier.Intents.BREAK_TRAVERSAL;return(a.aTagsCount+a.imgTagsCount)/(a.contentTagsCount+a.aTagsCount+a.imgTagsCount)>=m?(e.remove(),DomScorerModifier.Intents.BREAK_TRAVERSAL):void 0}}}}var d={TABLE:!0,TR:!0,TD:!0},g="relatedArticle",p=.5,m=.5,u=25,h=150,f=200,y=2.5,v=25,b=/gallery/i,C=/(\.{3,}|\u2026)$/,T=.3;return function(e){e.registerScoreFunction(g,l),e.registerBehaviorFunction(c,"after")}}(),socialShareClassifier=function(){function e(e){return e=e||{},{imgsCount:e.imgsCount||0,aCount:e.aCount||0,hasShareClass:e.hasShareClass||!1,hasShareImage:e.hasShareImage||!1}}function t(e,t){e.imgsCount+=t.imgsCount,e.aCount+=t.aCount,e.hasShareImage=e.hasShareImage||t.hasShareImage}function n(e){var t=e.className();return!(!t||!c.test(t))}function a(e){if("IMG"!==e.node.tagName)return!1;for(var t=e.node.nextElementSibling;t;){if($(t).find("a").length>1)return!0;t=t.nextElementSibling}return!1}function i(i){var r=e({hasShareClass:n(i),hasShareImage:a(i)}),o=mergeChildrenScoreHelperService(i,u,r,t);switch(i.node.nodeName){case"IMG":o.imgsCount++;break;case"A":o.aCount++}return o.hasShareClass=n(i),o}function r(e){var t=0;for(var n in e)"number"==typeof e[n]&&(t+=e[n]);return t}function o(e,t){for(var n=0,a=0,i=0,o=e.length;i<o;i++){var s=e[i],l=t.get(s);l&&(a++,n+=l)}var c=r(t.store);return{relatedCount:n,totalCount:c,relatedUniqCount:a,totalUniqCount:t.size,ratio:n/c||0}}function s(e){var t=e.scores[u];if(t.hasShareImage)return 0;if(t.hasShareClass)return 1;var n=o(d,e.scores.common.words);if(n.totalUniqCount>m)return 0;var a=o(g,e.scores.common.links);return 2*(n.relatedUniqCount>1?n.ratio:0)+(a.relatedUniqCount>1?a.ratio:0)}function l(e){if(!e.children.length)return DomScorerModifier.Intents.DO_NOTHING;var t=e.className(),n=e.node.tagName;return"TWITTER-WIDGET"===n||"BLOCKQUOTE"===n&&t.indexOf("twitter-tweet")>=0?(e.keep(),DomScorerModifier.Intents.BREAK_TRAVERSAL):s(e)>p?(e.remove(),DomScorerModifier.Intents.BREAK_TRAVERSAL):void 0}var c=/fb-like|daftplugPublicFacebookReactionsNotification|daftplugPublicFacebookReactionsNotification_container|daftplugPublicFacebookReactionsNotification_postTitle|daftplugPublicFacebookReactionsNotification_postTitle|socializer-share-bar|PIN_\d+/,d=["facebook","google","stumbleupon","reddit","pinterest","printfriendly","yum","twitter","tweet","linkedin","share","shares","print","tumblr","rss","youtube","social"],g=["twitter.com","facebook.com","reddit.com","myspace.com","stumbleupon.com","mix.com","mixx.com","viadeo.com","yummly.com","addthis.com","google.com","pinterest.com","printfriendly.com","mailto:","tumblr.com","linkedin.co","digg.com","whatsapp.com","vk.com","weibo.com","ok.ru","odnoklassniki.ru","xing.com","blogger.com","flipboard.com","meneame.net","mail.ru","icio.us","livejournal.com","delicious.com","youtube.com"],p=.3,m=25,u="shareScore";return function(e){e.registerScoreFunction(u,i),e.registerBehaviorFunction(l)}}(),DomScorerModifier=function(){function e(e){return e.nodeType===Node.TEXT_NODE&&!$.trim(e.nodeValue)}function t(e){return e instanceof n?e:e[c]}function n(e){this.node=e.node,this.node[c]=this,this.parent=e.parent,this.tree=e.tree,this.depth=e.depth||0,this.scores={},this.skipped=!1,this.hasScore=!1,this.keptChildren=[],this.children=[],this.prev=e.prev||null,this.next=null}function a(e){e.parent&&(e.skipped=!0)}function i(e,t){for(var n=e;n;)n.keptChildren.push(t),n=n.parent}function r(t,a){this.root=new n({tree:this,node:t}),this.scorer=a;for(var i=[this.root],r=null;r=i.shift();)for(var o=null,s=0,l=r.node.childNodes.length;s<l;s++){var c=r.node.childNodes[s];if(!e(c)&&c.nodeType!==Node.COMMENT_NODE&&"SCRIPT"!==c.tagName){var d=new n({tree:r.tree,parent:r,node:c,depth:r.depth+1,prev:o});o&&(o.next=d),o=d,r.children.push(d),i.push(d)}}}function o(){this.tree=new r(document.body,this),this.scoreFunctions={},this.markFunctions=[],this.behaviorFunctions={before:[],after:[]}}function s(e,t){for(var n=0,a=e.markFunctions.length;n<a;n++)e.markFunctions[n](t);for(var i in e.scoreFunctions){var r=e.scoreFunctions[i];t.scores[i]=r(t)}t.hasScore=!0}function l(e,t,n){e.tree.postOrderTraversal(function(e){e.hasScore||s(e.tree.scorer,e)}),e.tree.preOrderTraversalWithElementSkip(function(a){for(var i=0,r=e.behaviorFunctions[t].length;i<r;i++){if((0,e.behaviorFunctions[t][i])(a,n)===d.BREAK_TRAVERSAL)return d.BREAK_TRAVERSAL}})}var c="__DOM_SCORER_ELEMENT__",d={DO_NOTHING:"DO_NOTHING",BREAK_TRAVERSAL:"BREAK_TRAVERSAL",BREAK:"BREAK"};return n.prototype.hasId=function(e){return!!this.isElement()&&(this.node.getAttribute("id")||"").split(/\s/).indexOf(e)>=0},n.prototype.hasClass=function(e){return!!this.isElement()&&(this.node.getAttribute("class")||"").split(/\s/).indexOf(e)>=0},n.prototype.hasTagName=function(e){return!!this.isElement()&&this.node.tagName.toLowerCase()===e.toLowerCase()},n.prototype.nameMatches=function(e){if(!this.isElement())return!1;var t=this.node.getAttribute("id")||"",n=this.node.getAttribute("class")||"";return!![this.node.tagName,t,n].join(" ").match(e)},n.prototype.className=function(){return this.isElement()?this.node.getAttribute("class")||"":""},n.prototype.isElement=function(){return this.node.nodeType===Node.ELEMENT_NODE},n.prototype.forEachChild=function(e){for(var t=0,n=this.children.length;t<n&&(this.children[t].skipped||e(this.children[t],t)!==d.BREAK);t++);},n.prototype.keep=function(){a(this),this.parent&&i(this.parent,this)},n.prototype.skip=function(){a(this)},n.prototype.remove=function(){if(!this.skipped&&(a(this),this.node.parentNode&&this.node!==this.tree.root.node&&"BODY"!==this.node.nodeName))if(this.keptChildren.length){var e=this.tree.createElement("DIV");this.parent.replaceChild(e,this);for(var t=0,n=this.keptChildren.length;t<n;t++)e.appendChild(this.keptChildren[t])}else this.node.parentNode.removeChild(this.node)},n.prototype.getDepthLayer=function(){return this.tree.getDepthLayer(this.depth)},n.prototype.lastChild=function(){return this.children[this.children.length-1]},n.prototype.appendChild=function(e){if(e instanceof Node&&e.nodeType!==Node.ELEMENT_NODE)return void this.node.appendChild(e);var n=t(e),a=this.lastChild();a&&(a.next=n,n.prev=a),n.depth=this.depth+1,n.parent&&n.parent.children.length&&n.parent.children.splice(n.parent.children.indexOf(n),1),n.parent=this,this.children.push(n),this.node.appendChild(n.node)},n.prototype.replaceChild=function(e,n){var a=t(e),i=t(n);a.parent=this,a.depth=this.depth+1,a.scores=i.scores,a.skipped=i.skipped,a.keptChildren=i.keptChildren,a.children=i.children,a.prev=i.prev,a.next=i.next,i.parent=null,i.depth=0,i.prev=null,i.next=null,i.children=[];var r=this.children.indexOf(i);r>=0?this.children[r]=a:this.children.push(a),this.node.replaceChild(a.node,i.node)},r.prototype.createElement=function(e){return new n({node:document.createElement(e),tree:this})},r.prototype.createTextNode=function(e){return new n({node:document.createTextNode(e),tree:this})},r.prototype.getDepthLayer=memoize(function(e){var t=[];return this.breadthFirstTraversal(function(n){if(n.depth===e)t.push(n);else if(n.depth>e)return d.BREAK_TRAVERSAL}),t}),r.prototype.breadthFirstTraversal=function(e){var t=[];t.push(this.root);for(var n=null;(n=t.shift())&&e(n)!==d.BREAK_TRAVERSAL;)for(var a=0,i=n.children.length;a<i;a++){var r=n.children[a];t.push(r)}},r.prototype.preOrderTraversalWithElementSkip=function(e,t){t=t||this.root;for(var n=[t],a=null;a=n.shift();)if(!a.skipped&&e(a)!==d.BREAK_TRAVERSAL)for(var i=0,r=a.children.length;i<r;i++)n.push(a.children[i])},r.prototype.postOrderTraversal=function(e,t){t=t||this.root;for(var n=[],a=[t],i=null;i=a.pop();)if(!i.skipped){n.push(i);for(var r=0,o=i.children.length;r<o;r++)a.push(i.children[r])}for(var s=n.length;s--;)e(n[s])},o.toElem=t,o.Intents=d,o.elementFor=function(e){for(;e;){if(e[c])return e[c];if(e.childElementCount>1)return;e=e.firstElementChild}},o.prototype.registerScoreFunction=function(e,t){this.scoreFunctions[e]=t},o.prototype.registerMarkFunction=function(e){this.markFunctions.push(e)},o.prototype.registerBehaviorFunction=function(e,t){t||(t="before"),this.behaviorFunctions[t].push(e)},o.prototype.markAndCalcScore=function(){var e=this;this.tree.postOrderTraversal(function(t){s(e,t)})},o.prototype.rebuildTree=function(){this.tree=new r(document.body,this),this.markAndCalcScore()},o.prototype.beforeRunner=function(){l(this,"before")},o.prototype.afterRunner=function(e){this.tree.root=t(e),l(this,"after",{candidate:e})},o}(),isContentNodeHelperService=function(){var e=["SCRIPT","STYLE","NOSCRIPT","APPLET","EMBED","OBJECT","PARAM","IFRAME"];return function(t){return e.indexOf(t.nodeName)<0}}(),mergeChildrenScoreHelperService=function(){return function(e,t,n,a){for(var i=0,r=e.children.length;i<r;i++){a(n,e.children[i].scores[t])}return n}}(),sliceWordsService=function(){var e=/[^\d\^|\s|\$|\.|,|!|\?|\)|\(|"|\')]{2,}/g;return function(t){return $.trim(t).toLowerCase().match(e)||[]}}(),runDomScorerModifier=function(){var e=new DomScorerModifier;return commonScore(e),mustKeepClassifier(e),headerFooterClassifier(e),socialShareClassifier(e),relatedArticlesClassifier(e),doubleBrClassifier(e),emptyTagsClassifier(e),e.markAndCalcScore(),e},printYesUtils=function(){function e(e){return e.sort(function(e,t){return parseInt(e.dataset.pfPrintOrder,10)-parseInt(t.dataset.pfPrintOrder,10)})}function t(e,t){for(var n=[],a=0;a<t.length;a++){var i=t[a];e.indexOf(i.dataset.pfPrintYesId)<0&&n.push(i)}return n}return{extract:function(t){var n={"after-main":[],"before-main":[]},a=1e5,i=1;return $(t).find(".print-yes").each(function(){var e=this.dataset.pfPrintPosition||"after-main";this.dataset.pfPrintOrder||(this.dataset.pfPrintOrder=a,a++),this.dataset.pfPrintYesId=i,i++,n[e].push(this)}),n["after-main"]=e(n["after-main"]),n["before-main"]=e(n["before-main"]),n},apply:function(e,n){var a=$(e),i=[];a.find("[data-pf-print-yes-id]").each(function(){i.push(this.dataset.pfPrintYesId)}),a.prepend(t(i,n["before-main"])),a.append(t(i,n["after-main"]))}}}(),persistComputedStylesAndRect=function(){function e(e,t,n,i){for(var r=0,o=n.length;r<o;r++){var s=n[r],l=[a,i,s].join("_");e.dataset[l]=t[s]}}var t=["display","visibility"],n=["width","height"],a="pf";return function(a){var i=a.currentStyle||window.getComputedStyle(a);i&&e(a,i,t,"style");var r=a.getBoundingClientRect&&a.getBoundingClientRect();return"IMG"!==a.nodeName&&"SVG"!==a.nodeName&&"IFRAME"!==a.nodeName||r&&e(a,r,n,"rect"),{style:i,rect:r}}}(),toAbsoluteUrl=function(){var e=/^https?:\/\//i;return function(t,n){if(!t)return t;if(e.test(t))return t;if(t.startsWith("//"))return n.protocol+t;var a=n.protocol+"//"+n.hosts.page;return t.startsWith("/")||(t="/"+t),a+t}}(),messageBus=function(){var e=!1;return{postMessage:function(e,t,n){"root"===e?chrome.tabs.sendMessage(window.extensionRootTabId,{type:t,payload:n}):chrome.runtime.sendMessage({type:t,payload:n})},listen:function(t,n){e||(chrome.runtime.onMessage.addListener(function(e){try{if(!e)return;var a=e.type;if(!a)return;var i=t[a];if(!i)return;i(e.payload)}catch(e){if(!n)throw e;n(e)}}),e=!0)}}}(),$doc=$(document),pfData={},coreData={},PfAlgoStartHandler=function(e){$.extend(pfData,e.pfData),exTracker.init(pfData,function(){setup.start()})};messageBus.listen({PfStartAlgo:PfAlgoStartHandler,PfTwitterWidgetShadowDom:function(e){element=document.getElementById(e.id),element&&element.createShadowRoot&&(element.createShadowRoot(),element.shadowRoot.innerHTML=e.innerHTML,element.style.cssText=e.cssText)},PfTwitterTweetRendered:function(e){element=document.querySelector("#"+e.id),element.contentDocument.head.innerHTML=e.head,element.contentDocument.body.innerHTML=e.body,element.style.cssText=e.cssText},PfContentMaskAndScrollTop:function(){$("body").addClass("content-mask").removeClass("content-unmask"),window.scrollTo(0,0)},PfContentUnMask:function(){$("body").removeClass("content-mask").addClass("content-unmask")}});var setup={counter:0,init:function(){if(this.counter+=1,this.counter<30&&!document.body)return setTimeout(function(){setup.init()},13*this.counter);messageBus.postMessage("core","PfAlgoLoaded")},start:function(){try{logger.init(pfData),logger.time("algo.js Time"),document.body.innerHTML=pfData.page.body,pfData.page.bodyClassList&&pfData.page.bodyClassList.length&&document.body.setAttribute("class",document.body.getAttribute("class")+" "+pfData.page.bodyClassList.join(" ")),pfData.onServer||messageBus.postMessage("core","PfNSFWChecked",{state:"notNeededForCS",matchedPhrase:""});var e=runDomScorerModifier();setup.detectPlatforms(),htmlPreProcessor.run(e).always(function(){setup.removeHiddenContent(),setup.removePrintNo(),setup.addAppropriateClasses(),readability.extractAuthors(),readability.extractPubDate(),primaryImage.find(),pfData.page.enablePrintOnly&&(readability.extractCopyright(),readability.extractCustomHeaderFooter()),setup.cleanHTML(e),readability.init(e)})}catch(e){helper.runPostAlgoProcesses(contentData),exTracker.log(e)}},hasDomain:function(e){return pfData.config.domains.page===e||pfData.config.ssLocation&&-1!==pfData.config.ssLocation.indexOf(e)},detectPlatforms:function(){var e,t=/wp-content/i,n=/blogger.com/i,a=/squarespace.com/i,i=/wikihow.com/i,r=/weebly.com/i,o=pfData.config.ssStyleSheetHrefs||pfData.page.csStyleSheetHrefs;if(i.test(pfData.config.domains.page)||this.hasDomain("wikihow.com"))pfData.config.platform="wikihow";else if(this.hasDomain("nytimes.com"))pfData.config.platform="nytimes";else if(this.hasDomain("washingtonpost.com"))pfData.config.platform="washingtonpost";else if(-1!==$.inArray("mediawiki",pfData.page.bodyClassList))pfData.config.platform="mediawiki";else{var s=pfData.page.metas;for(e=0;e<s.length;e++){var l=s[e];"generator"===l.name&&"blogger"===l.content?pfData.config.platform="blogger":"blogger-template"===l.name&&"dynamic"===l.content?pfData.config.platform="blogger-dynamic":"al:ios:app_name"===l.property&&"Medium"===l.content&&(pfData.config.platform="medium")}if("unknown"===pfData.config.platform)for(e=0;e<o.length;e++){var c=o[e];if(t.test(c)){pfData.config.platform="wordpress";break}if(n.test(c)){pfData.config.platform="blogger";break}if(a.test(c)){pfData.config.platform="squarespace";break}if(r.test(c)){pfData.config.platform="weebly";break}}}contentData.platform=pfData.config.platform,"undefined"!=typeof pfData.config.platform&&analytics.sendEvent("Product","Platform: "+pfData.config.platform)},selectorsToRemove:function(){var e=[".pf-init-iframe",".sociable","#sociable",".addthis","#addthis",".printfriendly",".pf-print","#pf-print",".wp-socializer",".editsection",".a2a_dd",".addtoany_share_save",".addtoany_share_save_container",".simply-social-wrapper","#pf-mask",".social_button","#socialbookmarks",".articleFeedback",".print-no",".no-print",".ftwit",".famos-toolbar",".famos-fstar",".ftwit-drawer"],t=[".cufon img.canvas-png",".yarpp-related","#wdsb-share-box","#printfriendly","#print",".linkwithin_outer","#lws_0","#nrelate_related_0",".ccc-widget","#cccwr",".widget-cb",".doncaprio-share-buttons",".st_twitter_hcount",".st_pinterest_hcount",".st_digg_hcount",".st_stumbleupon_hcount",".st_fblike_hcount",".addthis_toolbox","#goog-gt-tt",".skiptranslate",".really_simple_share",".robots-nocontent","#sharebar",".sharebar",".articleExtras",".embed-mod",".pd-rating",".itxtrstimg",".itxthookicon",".w2bPinitButton","#twitter_h",".instaemail","#instaemail-button",".emailbutton","#share_print",".pinit-overlay",".pinit-button",".ngg_images",".mr_social_sharing_wrapper",".mapp-layout",".realtidbits-comments","#newsletter-promo",".newsletter-promo",".sharify-container",".sw-pinit-button",".jetpack-likes-widget-wrapper",".crunchify-social",".post-tags",".postmeta",".hreview-aggregate",".ratingblock",".nc_socialPanel",".outbrain",".related_post",".article-comments-post-wrapper",".articleComments",".modal-dialog",".load-screen","div.article-info img.squared-base",".rev_slider",".social-widget",".jw-player",".xnetvidplayer",".RelatedCoverage-relatedcoverage--LmkKX",".powerinbox",".email-sign-up",".article-prev-next",".related-posts",".related-cne-video-component","#Subscribe",".ColCMostViewed","#ColCFacebook",".amzn-native-container",".hidden-print",'div[aria-label="cookieconsent"]',"[class*='relatedposts']","[class*='zergnet-widget']","[data-spot-id]",".gm-style","select","textarea","label","button:not(.lightbox)","input"];return"mediawiki"===pfData.config.platform&&t.push([".noprint","div#jump-to-nav",".mw-jump","div.top","div#column-one","#colophon",".editsection",".toctoggle",".tochidden","div#f-poweredbyico","div#f-copyrightico","li#viewcount","li#about","li#disclaimer","li#mobileview","li#privacy","#footer-places",".mw-hidden-catlinks","tr.mw-metadata-show-hide-extended","span.mw-filepage-other-resolutions","#filetoc",".usermessage","#ca-delete","span.brokenref",".compact-ambox table .mbox-image",".compact-ambox table .mbox-imageright",".compact-ambox table .mbox-empty-cell",".compact-ambox .hide-when-compact",".check-icon a.new",".geo-nondefault",".geo-multi-punct",".nonumtoc .tocnumber",".toclimit-2 .toclevel-1 ul",".toclimit-3 .toclevel-2 ul",".toclimit-4 .toclevel-3 ul",".toclimit-5 .toclevel-4 ul",".toclimit-6 .toclevel-5 ul",".toclimit-7 .toclevel-6 ul",".mw-special-Watchlist #mw-watchlist-resetbutton",".wpb .wpb-header",".wpbs-inner .wpb-outside",".sysop-show",".accountcreator-show",".inputbox-hidecheckboxes form .inputbox-element","#editpage-specialchars",".wikipedia .ambox",".wikipedia .navbox",".wikipedia .vertical-navbox",".wikipedia .infobox.sisterproject",".wikipedia .dablink",".wikipedia .metadata",".editlink","a.NavToggle","span.collapseButton","span.mw-collapsible-toggle","#content cite a.external.text:after",".nourlexpansion a.external.text:after",".nourlexpansion a.external.autonumber:after",".skin-simple div#column-one",".skin-simple div#f-poweredbyico",".skin-simple div#f-copyrightico",".skin-simple .editsection","#siteNotice","div.magnify",".togglelink",".mw-editsection",".toctitle"]),{alwaysRemove:e.join(","),removeIfNotPrintOnly:t.join(",")}},cleanHTML:function(e){$("font").each(function(){var t=e.tree.createElement("span");forEachNodeChild(this,function(e){t.appendChild(e)}),DomScorerModifier.toElem(this.parentNode).replaceChild(t,this)}),$doc.find("input[type=password]").length>0&&(contentData.hasPasswordField=!0);var t=this.selectorsToRemove();$doc.find(t.removeIfNotPrintOnly).addClass("to-remove")
;var n=$doc.find("[class^='addthis_']"),a=n.prev();if(a.length){var i=a.text();i.length<50&&-1!==i.toLowerCase().match(/share this|follow us/)&&a.addClass("to-remove")}if(n.addClass("to-remove"),pfData.page.enablePrintOnly){$doc.find(".print-only, #print-only").find(".to-remove").addBack().removeClass("to-remove")}$doc.find(".to-remove").remove(),$doc.find(t.alwaysRemove).remove();try{$doc.find("#pf-content a").each(function(){var e=$(this);""===$.trim(e.html().replace("&nbsp;"," ","g"))&&e.remove()}),$doc.find("#pf-content div.separator").each(function(){var e=$(this);e.children().length==e.find("a,br").length&&e.addClass("img-separator")}),$doc.find(".pf-caption img, .wp-caption img, .caption img, .tr-caption-container img, .thumbinner img.thumbimage").each(function(){$(this).addClass("caption-img")}),$doc.find(".embed-responsive").removeClass("embed-responsive")}catch(e){}},removePrintNo:function(){pfData.page.enablePrintOnly&&$doc.find(".print-no, .pf-remove").remove()},selectorsNotToBeRemoved:[".copyright","#copyright",".delete-no",".delete-off",".pf-author",".print-content","#print-content",".pf-date","#pf-date",".pf-title",".pf-footer",".print-header",".print-footer",".print-yes",".pf-content","#pf-content"],hiddenImagesSelectors:["img[original]","img[data-lazy-src]","img[data-href]","img[data-src]","img[data-ezsrc]","img[data-layzr]","img[data-pagespeed-lazy-src]","img[data-original]","img[data-mediaviewer-src]","img[datasrc]","img[data-ct-lazy]","img[data-native-src]","img[data-original-src]","img[data-hi-res-src]","img[data-low-res-src]","img[data-raw-src]","img[nitro-lazy-src]","img[data-opt-src]","img[data-orig-src]","img[data-wpfc-original-src]","img[data-flickity-lazyload]","img.lazyload","img.lazyloaded",'img[itemprop="url"]','img[loading="lazy"]','img[data-load="false"]',"img.js-progressiveMedia-image","a[data-replace-image]","amp-img"],removeHiddenContent:function(){pfData.page.enablePrintOnly&&this.selectorsNotToBeRemoved.push(".print-only","#print-only");var e=$doc.find(this.selectorsNotToBeRemoved.join(",")),t="";e.find(".hidden-originally").removeClass("hidden-originally"),e.removeClass("hidden-originally"),e.parents().removeClass("hidden-originally"),$doc.find(this.hiddenImagesSelectors.join(",")).removeClass("hidden-originally"),t+=$doc.find(readability.wpContentParentTags.join(", ")).find(readability.wpContentTags.join(".hidden-originally, ")+".hidden-originally").map(function(){return $(this).attr("class")}).get().join(" "),t+=$doc.find(readability.wpContentParentTags.join(".hidden-originally, ")+".hidden-originally").map(function(){return $(this).attr("class")}).get().join(" "),t=t.replace(/hidden-originally/g,""),readability.wpContentParentTags=$.grep(readability.wpContentParentTags,function(e){return-1===t.indexOf(e.replace(".",""))}),readability.wpContentTags=$.grep(readability.wpContentTags,function(e){return-1===t.indexOf(e.replace(".",""))}),$doc.find(".hidden-originally").remove(),$doc.find(".hidden").removeClass("hidden")},addAppropriateClasses:function(){$("figcaption").parent("figure").addClass("pf-caption")}},logElIdClass=function(e){try{var t=e.id?"#"+e.id:"",n=e.className?"."+e.className:"";return e.tagName.toLowerCase()+t+n}catch(e){return""}},logEl=function(e){var t=e.readability?e.readability.contentScore.toFixed(2):"undefined";return logElIdClass(e)+" :: Score - "+t},contentData={hasContent:!1,title:"",description:"",author:"",dir:"ltr",customHeader:"",pubDate:"",customFooter:"",copyright:"",platform:"unknown",content:"",contentTextWithTitleAndUrl:"",contentTextLength:0,hasPasswordField:!1,nsfwState:"unknown",nsfwMatchedPhrase:null},config={negativeKeyWords:["archive","bookmark","share","login","aside","combx","comment","contact","foot","footer","footnote","form","masthead","meta","outbrain","related","scroll","shoutbox","sidebar","sponsor","shopping","tags","menu","authorp","breadcrumb","replies","reply"],positiveKeyWords:["article","body","content","entry","hentry","main","page","pagination","post","blog","story","ERSIngredientsHeader","ERSHeading","ERSSectionHead","ingredient","ingredients","dataTable","wsite-content","recipe-list","ico-ingridients","recipe-info","rcps-table-ingredients","product","footnote","recipe","wpurp-recipe-ingredients","learn-press-content-item"]},COOKING_WORDS_REGEXP=/ingredient|ingredients|recipe|salt|egg|eggs|honey|cream|organic|tablespoon|baking|chopped|cup|sugar|flour|rice|oil|salt|garlic|chili|egg|tsp|mozzarella|parmesan|garlic|tbsp|spoon|cocoa|butter|milk|waniliowy|cytrynowego|jajka|OUNCE|BONELESS|Preheat|oven|ONIONS|pizzico|Mascarpone|Formaggio|Parmigiano|Riso|Sale|pepe|Formaggio|Barbabietole|provola|Parmigiano|grattuggiato|Latte|affumicato|Scalogno|Cannella|Limone|Olio|noce/i,readability={version:"1.7.1",flags:7,hasContent:!0,titleText:null,titleTags:["h1","h2","h3"],wpContentParentTags:[".single-post article.hentry",".hentry",".single-post","article"],wpContentTags:[".post-content .fusion-fullwidth",".article",".entry-content",".entry_content",".entry",".format_text",".entrytext",".post-body",".post-content",".post-entry",".post_body",".post_content",".post_entry",".post_page-content"],wpPostImageSelectors:[".hentry .wp-post-image","header img.featured-image",".entry-thumb img",".hentry .featured-thumbnail.large img",".pinit-overlay img",".post-content .post-img img"],wpWooCommerceSelectors:[".main .product",'[data-elementor-type="wp-post"]',".woocommerce-cart-form",".cart-collaterals",".wc-product-table",".summary","#tab-description",".woocommerce-product-gallery__image",".woocommerce-product-gallery__image.flex-active-slide .zoomImg",".woocommerce-tabs .woocommerce-Tabs-panel",'[data-widget_type*="woocommerce-product"]'],run:0,debugLevel:1,textLimit:250,positiveTags:["article"],negativeTags:["aside","nav","footer"],FLAG_STRIP_UNLIKELYS:1,FLAG_WEIGHT_CLASSES:2,FLAG_CLEAN_CONDITIONALLY:4,parsedPages:{},unlikelyTags:["FOOTER"],regexps:{unlikelyCandidates:/combx|disqus|rss|shoutbox|ad-break|agegate/i,unlikelyCandidatesNavigation:/menu|sidebar|pagination|related-posts/i,primaryImageUnlikelyParents:/secondary|boxzilla/i,okMaybeItsACandidate:/content|and|article|body|column|main|extra|shadow|rightmen|header|content-sidebar-wrap|content-with-sidebar-wrp|pk_left_sidebar|artpag|has-sidebar|node-blog-entry|with-sidebar|widget-content|sp_sidebar|nd-no-sidebars|onecol-sidebar|page|financity-sidebar-wrap/i,negativePartialWord:new RegExp(config.negativeKeyWords.join("|"),"i"),negativeWholeWord:new RegExp("\\b"+config.negativeKeyWords.join("\\b|\\b"),"i"),positivePartialWord:new RegExp(config.positiveKeyWords.join("|"),"i"),positiveWholeWord:new RegExp("\\b"+config.positiveKeyWords.join("\\b|\\b"),"i"),extraneous:/print|archive|comment|discuss|e[\-]?mail|share|reply|all|login|sign|single/i,divToPElements:/<(a|blockquote|dl|div|img|ol|p|pre|table|ul)/i,replaceBrs:/(<br[^>]*>[ \n\r\t]*){2,}/gi,replaceFonts:/<(\/?)font[^>]*>/gi,normalize:/\s{2,}/g,videos:/http:\/\/(www\.)?(youtube|vimeo)\.com/i,period:/\.( |$)/,captions:/caption|figure/i,weight:/[\s\d]+(gram|gm|ml|kg|cup|pound|lb|spoon|tbsp)[s]?\s+/i,fractions:/[0-9]+\/[0-9]+/i,cookingWords:COOKING_WORDS_REGEXP,cookingWordsGlobal:new RegExp(COOKING_WORDS_REGEXP.toString(),"ig"),wpPostImage:/wp-post-image/i},wrapTextNodes:function(e,t){if(!e.tagName||-1===$.inArray(e.tagName.toUpperCase(),["PRE","CODE","SVG"]))if(e.nodeType===Node.TEXT_NODE){if($.trim(e.textContent)){var n=t.tree.createElement("span");n.node.className="text-node",DomScorerModifier.toElem(e.parentNode).replaceChild(n,e),n.appendChild(e)}}else e.childNodes.length>0&&forEachNodeChild(e,function(e){readability.wrapTextNodes(e,t)})},extractAuthors:function(){var e,t,n,a=[],i=[],r=/(^|\W)(by)(\W|$)/i,o=[".pf-author",".hentry a[rel=author]","a[rel=author]",".author.vcard .fn","[itemprop~=author] [itemprop~=name]","[itemprop~=author]",".byline","#author","header a[rel=author]",".hentry .post-author"],s=o.join(", ");if($.each(o,function(o,l){if(a=[],i=[],t=$doc.find(l).not(".widget *").not(".sidebar *"),t.length>=1&&-1===t[0].className.search(/combx|comment|community|disqus|extra|foot|header|menu|remark|rss|shoutbox|sidebar|sponsor|ad-break|agegate|pagination|pager|popup|tweet|twitter|tags|postmetadata/i)&&-1===$.inArray(this.nodeName,["INPUT"])){e=t.first();var c=e.parent(),d=c.parent(),g=null;if(c.find(s).length>1?g=c:d.find(s).length>1&&(g=d),g&&(e=g),e.addClass("algo-author"),e.find("sup").remove(),g?(g.find(l).each(function(){helper.extractText(a,this)}),a.join(" ").match(/,/)||(a=[a.join(", ")])):helper.extractText(a,e[0]),-1===e.text().search(r))try{n=e.parent(),i.push(n),0===n.prev().children().length&&i.push(n.prev()),$.each(i,function(e,t){var n=t.text();if(-1!==n.search(r)&&n.length<60)return a.unshift("By"),!1})}catch(e){}return contentData.author=a.join(" "),readability.author='<span id="pf-author">'+a.join(" ")+"</span>",!1}}),!readability.author){var l=$.grep(pfData.page.metas,function(e){return"author"===e.property});1===l.length&&l[0].content&&(contentData.author=l[0].content,readability.author='<span id="pf-author">'+l[0].content+"</span>")}},extractPubDate:function(){this.extractDateBySelectors([".pf-date","#pf-date",".Blog-meta-item--date"]),this.extractDateBySelectors([".hentry .entry-date",'.hentry .post-date time[itemprop="datePublished"]','.article-content--main time[itemprop="datePublished"]']),this.extractDateFromMeta("property","article:published"),this.extractDateFromMeta("property","article:published_time"),this.extractDateFromMeta("name","shareaholic:article_published_time"),this.extractDateFromMeta("itemprop","datePublished")},extractDateFromMeta:function(e,t){if("undefined"==typeof readability.pubDate){var n,a=helper.findMeta(pfData.page.metas,e,t),i=helper.findMeta(pfData.page.metas,"property","og:locale");if(1==i.length&&"undefined"!=typeof i[0].content&&(n=i[0].content.replace("_","-")),1==a.length&&"undefined"!=typeof a[0].content)try{var r=a[0].content.split("T")[0],o=new Date(r);if(!isNaN(o.getTime()))try{readability.pubDate=o.toLocaleDateString(n,{month:"long",year:"numeric",day:"numeric",timeZone:"UTC"})}catch(e){readability.pubDate=o.toLocaleDateString("en-US",{month:"long",year:"numeric",day:"numeric",timeZone:"UTC"})}}catch(e){}}},extractDateBySelectors:function(e){"undefined"==typeof readability.pubDate&&$.each(e,function(e,t){var n=$doc.find(t).not(".widget *").not(".sidebar *");if(1==n.length)return readability.pubDate=n.text(),n.remove(),!1})},extractCopyright:function(){var e=$doc.find(".copyright, #copyright");e.length>0&&(readability.copyright=e.clone().removeAttr("style"),e.remove())},extractCustomHeaderFooter:function(){var e=$doc.find(".print-header");1==e.length&&(readability.customHeader=$("<div />",document).append(e.clone().removeAttr("style")).html(),e.remove());var t=$doc.find(".pf-footer, .print-footer");t.length>0&&(readability.customFooter=$("<div />",document).append(t.clone().removeAttr("style")).html(),t.remove())},init:function(e){readability.prepDocument(e);var t=e.tree.createElement("DIV"),n=e.tree.createElement("DIV");helper.pickTitleFromContent();var a=readability.getArticleTitle(e),i=document.body.innerHTML,r=printYesUtils.extract(document.body);e.beforeRunner();var o=readability.grabArticle(e);o||(document.body.innerHTML=i,e.rebuildTree(),readability.textLimit=250,readability.run=0,o=readability.grabArticle(e),o?exTracker.log(new Error("runDomScorerModifier removes main content")):(o=e.tree.createElement("DIV").node,o.id="pf-content",readability.hasContent=!1)),readability.articleTitle=a.node,readability.articleContent=o,e.afterRunner(o),readability.titleText?readability.articleTitle.innerHTML=readability.titleText:readability.titleText=$.trim($(readability.articleTitle).text()),$(o).find(readability.titleTags.join(",")).each(function(){readability.titleText==$.trim($(this).text())&&$(this).remove()}),t.node.id="printfriendly",n.node.id="pf-print-area",a.node.id="pf-title",pfData.onServer||(n.appendChild(a),n.appendChild(o),t.appendChild(n),document.body.innerHTML="",DomScorerModifier.toElem(document.body).appendChild(t),document.body.removeAttribute("style")),primaryImage.prependTo(o),readability.hasContent&&(readability.wrapTextNodes(o,e),printYesUtils.apply(o,r)),contentData.hasContent=readability.hasContent,contentData.title=readability.getInnerText(a.node),descriptions=$.grep(pfData.page.metas,function(e){return"description"===e.name}),descriptions.length&&(contentData.description=descriptions[0].content),contentData.dir=readability.getSuggestedDirection(o.textContent),contentData.content=o.innerHTML;var s=pfData.config.ssLocation||"";contentData.contentTextWithTitleAndUrl=s+o.textContent+contentData.title,contentData.contentTextLength=o.textContent.length,contentData.lang=pfData.page.language,logger.timeEnd("algo.js Time"),helper.runPostAlgoProcesses(contentData)},getSuggestedDirection:function(e){function t(){return e.replace(/@\w+/,"")}function n(t){var n=e.match(new RegExp(t,"g"));return null!==n?n.length:0}function a(){return 100*(n("[\\u05B0-\\u05F4\\uFB1D-\\uFBF4]")+n("[\\u060C-\\u06FE\\uFB50-\\uFEFC]"))/e.length>20}return e=t(e),a()?"rtl":"ltr"},getArticleTitle:function(e){var t,n,a,i,r,o,s=null;if(t=["h1","h2","h3"],i=$doc.find(".pf-title"),1==i.length&&(logger.log("Picking title using .pf-title"),s=i),s||(i=$doc.find('header [itemprop~="headline"]'),1==i.length&&""!==$.trim(i.text())&&(logger.log("Picking title using header itemprop~=headline"),s=i)),s||"blogger"!==pfData.config.platform&&"wordpress"!==pfData.config.platform||(n=[".post-title",".entry-title"],"wordpress"===pfData.config.platform&&n.push(".post_title",".posttitle","#page-title","#pagetitle","#title",".title",".entry-header"),a=[],$.each([".single-post",".post","#post",".hentry"],function(e,i){0===$doc.find(".pf-body-cache"+i).length&&$.each(t,function(e,t){$.each(n,function(e,n){a.push(i+" "+n+" "+t),a.push(i+" "+t+n)})})}),$.each(a,function(e,t){if(i=$doc.find(t),1===i.length&&""!==$.trim(i.text()))return logger.log("Picking title using WP/blogger classes"),s=i,!1})),s||"squarespace"!==pfData.config.platform||(n=["article .BlogItem-title"],$.each(n,function(e,t){if(i=$doc.find(t),1===i.length&&""!==$.trim(i.text()))return logger.log("Picking title using squarespace classes"),s=i,!1})),!s&&""!==$.trim($("title",document).text())){var l=$.trim($("title",document).text()).toLowerCase().replace(/\W+/g,""),c=0;$.each(t,function(e,t){$doc.find(t).each(function(e,t){var n=l.match($(t).text().toLowerCase().replace(/\W+/g,""));n&&n[0].length>15&&n[0].length>c&&(logger.log("Using title element which had a substring of document title"),c=n[0].length,s=$(t))})})}if(s||(r=$doc.find("article header"),r.length>0&&$.each(t,function(e,t){return i=r.find(t),!(i.length>1)&&(1==i.length?(logger.log("Picking title using article header, header h-tags"),s=i,!1):void 0)})),s)return readability.titleText=$.trim(s.text()),readability.titleTags.push(s[0].nodeName),o=e.tree.createElement("H1");var d="",g="";try{d=g=document.title,"string"!=typeof d&&(d=g=readability.getInnerText(document.getElementsByTagName("title")[0]))}catch(e){}if(d.match(/ [\|\-] /))d=g.replace(/(.*)[\|\-] .*/gi,"$1"),d.split(" ").length<3&&(d=g.replace(/[^\|\-]*[\|\-](.*)/gi,"$1"));else if(-1!==d.indexOf(": "))d=g.replace(/.*:(.*)/gi,"$1"),d.split(" ").length<3&&(d=g.replace(/[^:]*[:](.*)/gi,"$1"));else if(d.length>150||d.length<15){var p=document.getElementsByTagName("h1");1===p.length&&(d=readability.getInnerText(p[0]))}return d=$.trim(d),d.split(" ").length<=4&&(d=g),o=e.tree.createElement("H1"),o.node.innerText=d,o},prepDocument:function(e){if(null===document.body){var t=e.tree.createElement("body");try{document.body=t}catch(e){document.documentElement.appendChild(t.node),logger.log(e)}}document.body.id="pf-body"},prepArticle:function(e){readability.cleanStyles(e),readability.clean(e,"object")},initializeNode:function(e){switch(e.readability={contentScore:0},e.tagName){case"ARTICLE":e.readability.contentScore+=15;break;case"ASIDE":case"NAV":e.readability.contentScore-=15;break;case"DIV":e.readability.contentScore+=5;break;case"PRE":case"TD":case"BLOCKQUOTE":e.readability.contentScore+=3;break;case"ADDRESS":case"OL":case"UL":case"DL":case"DD":case"DT":case"LI":case"FORM":e.readability.contentScore-=3;break;case"H1":case"H2":case"H3":case"H4":case"H5":case"H6":case"TH":e.readability.contentScore-=5}e.readability.contentScore+=readability.getClassWeight(e)},getTextScore:function(e){var t=0;return t+=e.split(",").length,t+=Math.min(Math.floor(e.length/100),3),e&&(t+=(e.match(readability.regexps.cookingWordsGlobal)||[]).length/e.length*50),t},isUnlikelyCandidate:function(e,t){if(readability.unlikelyTags.indexOf(e.tagName)>=0)return!0;var n=e.className+" "+e.id+" "+e.nodeName;return"image"===t?readability.regexps.unlikelyCandidates.test(n)||readability.regexps.primaryImageUnlikelyParents.test(n):(readability.regexps.unlikelyCandidates.test(n)||readability.regexps.unlikelyCandidatesNavigation.test(n)&&e.querySelector("a"))&&!readability.regexps.okMaybeItsACandidate.test(n)&&!e.querySelector(readability.positiveTags.join(","))&&"BODY"!==e.tagName&&-1===$.inArray(e.tagName.toLowerCase(),readability.positiveTags)},hasUnlikelyParent:function(e){return $(e).parents().is(function(){return readability.isUnlikelyCandidate(this,"image")})},skipSchemaSelectorsDomain:function(){for(var e=["reuters.com"],t=pfData.config,n=0,a=e.length;n<a;n++){var i=e[n];if(t.domains.page.indexOf(i)>=0||t.ssLocation&&t.ssLocation.indexOf(i)>=0)return!0}return!1},isWooCommerce:function(){var e="|"+pfData.page.bodyClassList.join("|")+"|",t=/\|[^|]*?woocommerce.*?\|/i.test(e),n=/\|home\|/i.test(e),a=/\|single-product\|/i.test(e);return t&&(a||!n)},grabArticle:function(e,t){readability.run+=1;var n,a,i,r,o,s,l="added-to-list"+readability.run,c=[];pfData.page.enablePrintOnly&&c.push(".print-only","#print-only");var d=".printfriendly.pf-alignright, .printfriendly.pf-alignleft, .printfriendly.pf-aligncenter",g=$doc.find(".pf-content, #pf-content");if(g.find(d).remove(),(""!==$.trim(g.text())||g.find("img").length>0||-1!==$.inArray("IMG",$.map(g,function(e){return e.nodeName})))&&c.push(".pf-content","#pf-content"),a=pfData.page.enablePrintOnly?$doc.find(c.join(",")):$(),0===a.length){switch(pfData.config.platform){case"blogger-dynamic":n=$doc.find(".overview-content .entry-content, .viewitem-content .entry-content"),n.length>0&&(n.find(".post-title, .entry-title, .post-header, .post-footer").remove(),a=n);break;case"blogger":n=$doc.find("#main").find(".post-body, .entry-content, .post-title, .entry-title"),n.length>0&&(n.find(".post-title, .entry-title, .post-header, .post-footer").remove(),a=n);break;case"wordpress":var p=[".fl-module-fl-post-content"];this.isWooCommerce()&&(p=p.concat(readability.wpWooCommerceSelectors)),$.each(readability.wpContentParentTags,function(e,t){$.each(readability.wpContentTags,function(e,n){p.push(t+" "+n)})}),p.push('[data-elementor-type="wp-post"]'),a=$doc.find(p.join(",")),a=$($.grep(a,function(e){return 0===$(e).parents(".fl-col-small").length}));break;case"weebly":n=$doc.find("#wsite-content .blog-content"),1===n.length&&(n.text().length>20||n.find("img").length>0)&&(a=n);break;case"wikihow":n=$doc.find("#bodycontents"),1===n.length&&(n.text().length>20||n.find("img").length>0)&&(a=n);break;case"medium":n=$doc.find("article.postArticle--full > .postArticle-content"),1===n.length&&(n.text().length>20||n.find("img").length>0)&&(a=n);break;case"washingtonpost":a=$doc.find(".article-body .teaser-content, .remainder-content");break;case"nytimes":if(n=$doc.find(".story-body"),n.length>=1&&(a=n),0===a.length){var m=$.grep(pfData.page.metas,function(e){return"slug"===e.name});m.length&&(n=$doc.find("#"+m[0].content),n.length>=1&&(a=n))}0===a.length&&(n=$doc.find("article#story"),n.length>=1&&(n.find('nav, header, footer, #bottom-wrapper, #newsletter-module, .bottom-of-article, [class^="ResponsiveAd"], div [class^="SectionBar"], div[class^="elementStyles-recirculation"], [class^="InlineMessage"]').remove(),a=n));break;case"squarespace":var u='#productSummary, .product-description, #content, .Main-content, .BlogItem, .hentry, main, article div[data-layout-label="Post Body"]'.split(",");$.each(u,function(e,t){if(n=$doc.find(t),(1===n.length||2===n.length)&&(n.text().length>20||n.find("img").length>0))return n.find(".product-quantity-input, .sqs-add-to-cart-button-wrapper, .product-variants, .product-sharing, aside, .entry-header, .entry-footer, nav, .Blog-meta, .BlogItem-share, .Index-page-scroll-indicator").remove(),a=n,!1})}if(!this.skipSchemaSelectorsDomain()){var h=['[itemtype*="schema.org/Article"] [itemprop~=articleBody]','[itemtype*="schema.org/NewsArticle"] [itemprop~=articleBody]','[itemtype*="schema.org/Report"] [itemprop~=articleBody]','[itemtype*="schema.org/ScholarlyArticle"] [itemprop~=articleBody]','[itemtype*="schema.org/TechArticle"] [itemprop~=articleBody]','[itemtype*="schema.org/Recipe"]','[itemtype*="schema.org/ScholarlyArticle"] [data-article-body]'];$.each(h,function(e,t){var n=$doc.find(t);if(1===n.length&&readability.getInnerText(n[0]).length>250)return a=n,!1})}}var f=$.grep(a,function(e){return"BODY"==e.tagName}).length>0;if(a.length>0&&!f&&(a.find(".navbar, .flex-direction-nav, .yarpp-related, .articleInline, .bottom-meta, .bottomnavigation, #branding, .commentlist, #commentwrapper, #comments, .comments, #disqus_thread, .entry-meta, .igit_relpost, #navbar, .nocomments, .noprint, .pd-rating, .pin-it-btn-wrapper, .post-actions, .post-comments, .post-extras, .post-footer, .post_footer, .post-header, .post-info, .post .meta, .post-meta, .postmeta, .postmetadata, .post_nav, .post_tags, .prev_next, .print-no, .respond, #respond, #sharebar, .shareTools, .share-buttons, .shareTop, .share_this, #sharebarx, .share_box, .sharedaddy, .share_icons, .shr-bookmarks, .sociable, .social_button, .social-ring, .socialwrap, .wpadvert, .wp-socializer, .editorial-disclosure").remove(),a.find(d).remove(),"wikihow"===pfData.config.platform?a.find("#method_toc, .altadder_section, .relatedwikihows, .ad_label, .wh_ad, .wh_ad_inner, .video, .step_num").remove():"nytimes"===pfData.config.platform&&a.find("footer, .visually-hidden").remove(),""!==$.trim(a.text())||a.find("img").length>0||-1!==$.inArray("IMG",$.map(a,function(e){return e.nodeName})))){logger.log("Bypassed readability and found content using "+pfData.config.platform+" rules");var y=e.tree.createElement("DIV");if(y.node.id="pf-content","wordpress"===pfData.config.platform){$.each(readability.wpPostImageSelectors,function(e,t){var n=$doc.find(t);if(1===n.length){var i=n.first();if(!primaryImage.findSameImage(primaryImage.getImageOrigSrc(i[0],a)))return"FIGURE"===i.parent()[0].nodeName&&(i=i.parent()),y.appendChild(i[0]),logger.log("Picked WP Post Image using selector - "+t),!1}});var v=$doc.find(".single-recipe-ingredients");1===v.length&&0===a.find(".single-recipe-ingredients").length&&y.appendChild(v[0])}a.find("*[style]").addBack().each(function(){this.setAttribute("orig-style",this.getAttribute("style")),this.removeAttribute("style")});var b=a.text().length;a.find("aside").text().length<.15*b&&a.find("aside").remove();for(var C=0,T=a.length;C<T;C++){var w=a[C];0===$(y.node).has(w).length&&y.appendChild(w)}return y.node}var S=readability.flagIsActive(readability.FLAG_STRIP_UNLIKELYS),I=null!==t;t=t||document.body;var E=t.innerHTML,x=[];if(t.children&&t.children.length)for(var N=0,D=t.children.length;N<D;N++)x.push(t.children[N]);for(var A,k=null,L=[],P=["P","PRE","TD","UL","OL"],_=["SPAN","B"];k=x.shift();)if(i=null,S&&readability.isUnlikelyCandidate(k))logger.log("Removing unlikely candidate - "+logElIdClass(k)),k.parentNode.removeChild(k);else{if($.inArray(k.tagName,P)>-1&&!commonUtils.hasClass(k,"pf-br-replacement"))L.push(k);else if($.inArray(k.tagName,_)>-1&&1===k.childNodes.length&&k.childNodes[0].nodeType===Node.TEXT_NODE&&readability.getInnerText(k).length>30){do{i=helper.findNonExclusiveParent(i||k)}while(!i||$.inArray(i.tagName,_)>-1);commonUtils.hasClass(i,l)||L.push(i)}else if("DIV"===k.tagName)if(-1===k.innerHTML.search(readability.regexps.divToPElements))try{var M=e.tree.createElement("p");forEachNodeChild(k,function(e){M.appendChild(e)}),DomScorerModifier.toElem(k.parentNode).replaceChild(M,k),M.node.id=k.id,M.node.className=k.className,L.push(M.node)}catch(e){L.push(k),logger.log("Could not alter div to p, probably an IE restriction, reverting back to div.: "+e)}else forEachNodeChild(k,function(t){try{if(t.nodeType===Node.TEXT_NODE&&$.trim(t.nodeValue)){var n=e.tree.createElement("span");pfData.browser.isIE&&pfData.browser.version<10&&(t.innerHTML="&nbsp;"+t.nodeValue),DomScorerModifier.toElem(k).replaceChild(n,t),n.appendChild(t)}else t.nodeType===Node.COMMENT_NODE&&k.removeChild(t)}catch(e){}});if(L[L.length-1]&&commonUtils.addClassTo(L[L.length-1],l),k.children&&k.children.length)for(var R=0,O=k.children.length;R<O;R++)x.push(k.children[R])}a=[];for(var B=0;B<L.length;B++){s=!1;var F=L[B];$.inArray(F.tagName,["SECTION","DIV","ARTICLE"])>-1&&F.children&&F.children.length>1?(i=F,s=!0):i=helper.findNonExclusiveParent(F),i&&"undefined"!=typeof i.tagName&&(r=readability.getInnerText(F),r.length<25&&!helper.isRecipeIngredient(r)&&!helper.isLinkTextOnly(F,r)||r.length<5||(o=helper.findNonExclusiveParent(i),A=readability.getTextScore(r),!s&&commonUtils.hasClass(i,l)||("undefined"==typeof i.readability&&(readability.initializeNode(i),a.push(i)),i.readability.contentScore+=A),!o||"undefined"==typeof o.tagName||commonUtils.hasClass(i,l)||commonUtils.hasClass(o,l)||("undefined"==typeof o.readability&&(readability.initializeNode(o),a.push(o)),o.readability.contentScore+=.9*A),readability.debugLevel>3&&(logger.log("Node: "+logElIdClass(F)),logger.log("Text Score: "+A),logger.log("Parent: "+logEl(i)),o&&"undefined"!=typeof o.readability&&logger.log("grandParent: "+logEl(o)),logger.log(""))))}for(var H=null,W=0,U=a.length;W<U;W++)a[W].readability.contentScore=a[W].readability.contentScore*(1-readability.getLinkDensity(a[W]));a.sort(function(e,t){var n=e.readability.contentScore,a=t.readability.contentScore;return n<a?1:n===a?0:-1}),logger.log("Top 5 Candidates");for(var C=0,z=Math.min(5,a.length);C<z;C++)logger.log(logEl(a[C]));if(a.length>0){H=a[0];var j=Math.min(H.readability.contentScore,100),G=.5*j,V=[],q=.9*j;if($.each(a,function(e,t){if($candidate=$(t),$candidate.parents(".pf-candidate").length>0)return!0;$candidate.find(".pf-candidate").length>0&&("ARTICLE"===t.tagName&&t.readability.contentScore>=G||t.readability.contentScore>=q)&&(H=t,V[0]=t),$candidate.addClass("pf-candidate"),t.readability.contentScore>=G&&V.push(t)}),V.length>1)try{if(H=helper.getCommonAncestor(V),"BODY"===H.tagName){var K=function(e){return"TBODY"===e.tagName?e.parentElement:e},Y=e.tree.createElement("div"),X=K(a[0]);DomScorerModifier.toElem(X.parentElement).replaceChild(Y,X),Y.appendChild(X),Y.node.readability=X.readability;for(var C=0,T=V.length;C<T;C++)Y.appendChild(K(V[C]));H=Y.node,logger.log("Combining top candidates")}else logger.log("Changing Top Candidate to Ancestor")}catch(e){H=a[0]}}if(null===H||"BODY"===H.tagName){logger.log("Top Candidate NULL or BODY");for(var Z=e.tree.createElement("DIV"),J=t.firstChild;J;)Z.appendChild(J),J=t.firstChild;DomScorerModifier.toElem(t).appendChild(Z),H=Z.node}if("medium"===pfData.config.platform){var Q=$(H).parents("article");if(1===Q.length){logger.log("Changing Top Candidate to Ancestor article");for(var ee=Q.find("section").filter(function(){return!!this.innerText.length}),te=["h1","h2","h3","h4","p","pre","code","ul","ol","figure","img"],ne=[],C=0,z=te.length;C<z;C++){var ae=te[C];ne.push([ae,ae+">*",":has("+ae+")"].join(","))}$(ee[0]).find(":not("+ne.join(",")+")").remove(),H=Q[0]}}"TBODY"===H.nodeName&&(H=H.parentNode),"undefined"==typeof H.readability&&readability.initializeNode(H),logger.log("Top Candidate: "+logEl(H));var ie=e.tree.createElement("DIV");I&&(ie.node.id="pf-content");var re=Math.max(10,.2*H.readability.contentScore),oe=H.parentNode?Array.prototype.slice.call(H.parentNode.childNodes):[],se=null;1===$(H).prev().find("img").length&&(se=$(H).prev()[0],ie.appendChild(se)),1===$(H).parent().prev().find("img").length&&ie.appendChild($(H).parent().prev()[0]);for(var le=0,ce=oe.length;le<ce;le++){var de=oe[le],ge=!1,pe=["p","div","ul","ol","table","tr","td","tbody","blockquote"],me=0,ue="",he=de.id+" "+de.className;if(de&&de!==se){if(readability.debugLevel>3&&logger.log("Looking at sibling node: "+logEl(de)),de.className===H.className&&""!==H.className&&(me+=.2*H.readability.contentScore),de===H)ge=!0,ue="top candidate";else{if(readability.regexps.negativeWholeWord.test(he))continue;if("undefined"!=typeof de.readability&&de.readability.contentScore+me>=re)ge=!0,ue="content score + contentbonus > threshold";else if($.inArray(de.nodeName.toLowerCase(),pe)>-1){var fe=readability.getLinkDensity(de),ye=readability.getInnerText(de),ve=ye.length,be=de.getElementsByTagName("a").length,Ce=de.getElementsByTagName("img").length;ve>300&&fe<.25?(ge=!0,ue="Long content with low link density"):ve>80&&fe<.25&&be<3?(ge=!0,ue="Possibly long content with low link density & link count < 3"):ve<80&&0===fe&&-1!==ye.search(readability.regexps.period)?(ge=!0,ue="Short content with no links and has periods (.)"):be<2&&1==Ce&&(ge=!0,ue="link count < 2 with one image")}}if(ge){logger.log("Appending node: "+logEl(de)+" -- because "+ue);var Te=null;"DIV"!==de.nodeName&&"P"!==de.nodeName&&"TABLE"!==de.nodeName?(Te=e.tree.createElement("DIV"),Te.node.id=de.id,forEachNodeChild(de,function(e){Te.appendChild(e)})):Te=DomScorerModifier.toElem(de),Te.node.className="",ie.appendChild(Te)}}}return readability.prepArticle(ie.node),readability.getInnerText(ie.node).length<readability.textLimit?(logger.log("****Text length less than "+readability.textLimit+" ****"),t.innerHTML=E,e.rebuildTree(),e.beforeRunner(),readability.flagIsActive(readability.FLAG_STRIP_UNLIKELYS)?(readability.removeFlag(readability.FLAG_STRIP_UNLIKELYS),logger.log("Turning off FLAG_STRIP_UNLIKELYS"),readability.grabArticle(e,t)):readability.flagIsActive(readability.FLAG_WEIGHT_CLASSES)?(readability.removeFlag(readability.FLAG_WEIGHT_CLASSES),logger.log("Turning off FLAG_WEIGHT_CLASSES"),readability.grabArticle(e,t)):readability.flagIsActive(readability.FLAG_CLEAN_CONDITIONALLY)?(readability.removeFlag(readability.FLAG_CLEAN_CONDITIONALLY),logger.log("Turning off FLAG_CLEAN_CONDITIONALLY"),readability.grabArticle(e,t)):250===readability.textLimit?(logger.log("*** Reducing text limit to 75 ***"),readability.textLimit=75,readability.addFlag(readability.FLAG_STRIP_UNLIKELYS),readability.addFlag(readability.FLAG_WEIGHT_CLASSES),readability.addFlag(readability.FLAG_CLEAN_CONDITIONALLY),readability.grabArticle(e,t)):null):ie.node},getInnerText:function(e,t){if("undefined"==typeof e.textContent)return"";t=void 0===t||t;var n=$.trim(e.textContent);return t&&(n=n.replace(readability.regexps.normalize," ")),n},getCharCount:function(e,t){return t=t||",",readability.getInnerText(e).split(t).length-1},cleanStyles:function(e){e=e||document;var t=e.firstChild;if(e)for("function"==typeof e.removeAttribute&&"pf-styled"!==e.className&&(e.setAttribute("orig-style",e.getAttribute("style")),e.removeAttribute("style"));null!==t;)t.nodeType===Node.ELEMENT_NODE&&("pf-styled"!==t.className&&(t.setAttribute("orig-style",t.getAttribute("style")),t.removeAttribute("style")),readability.cleanStyles(t)),t=t.nextSibling},getLinkDensity:function(e){for(var t=e.getElementsByTagName("a"),n=readability.getInnerText(e).length,a=0,i=0,r=t.length;i<r;i+=1)a+=readability.getInnerText(t[i]).length;return a/n},getClassWeight:function(e){if(!readability.flagIsActive(readability.FLAG_WEIGHT_CLASSES))return 0;var t=0,n=e.id+" "+e.className;return-1!==n.search(readability.regexps.negativePartialWord)&&-1===$.inArray(e.nodeName.toLowerCase(),readability.positiveTags)&&(t-=25),-1!==n.search(readability.regexps.positivePartialWord)&&-1===$.inArray(e.nodeName.toLowerCase(),readability.negativeTags)&&(t+=25),t},nodeIsVisible:function(e){return(0!==e.offsetWidth||0!==e.offsetHeight)&&"none"!==e.style.display.toLowerCase()},clean:function(e,t){for(var n=e.getElementsByTagName(t),a="object"===t||"embed"===t,i=n.length-1;i>=0;i-=1){if(a){for(var r="",o=0,s=n[i].attributes.length;o<s;o+=1)r+=n[i].attributes[o].value+"|";if(-1!==r.search(readability.regexps.videos))continue;if(-1!==n[i].innerHTML.search(readability.regexps.videos))continue}n[i].parentNode.removeChild(n[i])}},htmlspecialchars:function(e){return"string"==typeof e&&(e=e.replace(/&/g,"&amp;"),e=e.replace(/"/g,"&quot;"),e=e.replace(/'/g,"&#039;"),e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;")),e},flagIsActive:function(e){
return(readability.flags&e)>0},addFlag:function(e){readability.flags=readability.flags|e},removeFlag:function(e){readability.flags=readability.flags&~e}},primaryImage={primaryImageHTML:null,find:function(){try{var e=this.wpPostImage()||this.metaImage()||this.largeImage();e&&!e.src&&(e=e.querySelector("img")),e&&e.src&&(this.primaryImageHTML=e.outerHTML)}catch(e){exTracker.log(e)}},largeImage:function(){for(var e=document.querySelectorAll(".pf-large-image"),t=0;t<e.length;t++){var n=e[t];if(!readability.isUnlikelyCandidate(n,"image")&&!readability.hasUnlikelyParent(n))return n}},wpPostImage:function(){var e;if("wordpress"===pfData.config.platform&&$.each(readability.wpPostImageSelectors,function(t,n){var a=$(document).find(n);if(1===a.length)return e=a.first(),"FIGURE"===e.parent()[0].nodeName&&(e=e.parent()),logger.log("Picked WP Post Image using selector - "+n),!1}),e)return e[0]},metaImage:function(){var e=this.metaContentAttr("property","og:image")||this.metaContentAttr("name","twitter:image")||this.metaContentAttr("itemprop","image");return e?this.findSameImage(e,document.body):null},metaContentAttr:function(e,t){var n=$.grep(pfData.page.metas,function(n){return n[e]===t});return n.length?n[0].content:null},prependTo:function(e){if(pfData.page.hasPrintOnly&&pfData.page.enablePrintOnly)return void logger.log("Primary Image: SKIPPED, has print-only");if(!this.primaryImageHTML)return void logger.log("Primary Image: SKIPPED, no candidates");var t=$(this.primaryImageHTML),n=this.getImageOrigSrc(t[0]);this.findSameImage(n,e)?logger.log("Primary Image: ALREADY EXISTS src = "+n):(t.addClass("blockImage").addClass("pf-primary-img"),$(e).prepend(t),logger.log("Primary Image: ADDED src = "+n))},findSameImage:function(e,t){e=this.cleanSrc(e),e=decodeURI(e);var n=null;return $("img, picture source",t).each(function(){var t=primaryImage.getImageOrigSrc(this);if(!t)return!0;t=primaryImage.cleanSrc(t),t=decodeURI(t);var a=primaryImage.getImageOrigSrcSet(this);return a=decodeURI(a),t===e||-1!==a.indexOf(e)||-1!==e.indexOf(t)||-1!==t.indexOf(e)?(n=this,!1):void 0}),n},getImageOrigSrc:function(e){return pfData.onServer?e.getAttribute("pf-orig-src")||e.src:e.src},getImageRestoreSrc:function(e){return pfData.onServer?e.getAttribute("pf-restore-src"):e.src},getImageOrigSrcSet:function(e){return pfData.onServer?e.getAttribute("pf-orig-srcset"):e.srcset},cleanSrc:function(e){return e=e.replace(/format=\d+w/g,""),e=e.replace(/www\./g,""),e=e.replace(/[-_]\d{1,4}x\d{1,4}/,"")}},imageProcessor={init:function(){$doc.find("#pf-content img").addClass("flex-width"),$doc.find(".wp-caption img, .caption img, .tr-caption-container img, .thumbinner img.thumbimage").addClass("caption-img").removeClass("flex-width"),this.resizeImageCssClass=commonUtils.resizeImageCssClass(pfData.userSettings.imagesSize),this.fixLazyLoadImages(),this.fixResponsiveImages(),this.fixMediumImages(),this.convertImagesToBase64(),this.layoutImages.setDisplayStyle(),this.layoutImages.init()},convertImagesToBase64:function(){$("img").each(function(){var e=this;e.src&&toBase64URL(e.src,function(t){e.src=t})})},fixResponsiveImages:function(){var e={},t=function(t){e[t]||(toBase64URL(t.currentSrc||t.src,function(e){t.src=e}),t.removeAttribute("srcset"),e[t]=!0)};$doc.find("img[srcset]").each(function(){var e=this,n=e.getAttribute("srcset"),a=e.getAttribute("pf-data-srcset");n!==a&&e.setAttribute("srcset",a),e.onload=function(){t(this)},e.onerror=function(){t(this)}})},fixMediumImages:function(){$doc.find("img.ix.iy").remove(),$doc.find("img").each(function(){var e=this;if(e.src&&/miro\.medium\.com/i.test(e.src)){var t=e.src.split("/"),n=t[t.length-1];$doc.find('img[src*="'+n+'"]').filter(function(){return this!==e}).remove(),e.src=e.src.replace(/q=\d+/,"q=100").replace(/max\/\d+\//,"max/1200/")}})},interpolationUrlRegexp:/([\?&][^=]*={[^\}]*})/,imgUrlRegexp:/(http(s?):)|([\/|.|\w|\s])*\.(?:jpg|gif|png|img)/i,lazyImgDataAttributes:["original","data-lazy-src","data-href","data-src","data-ezsrc","data-layzr","data-pagespeed-lazy-src","data-original","data-mediaviewer-src","datasrc","data-ct-lazy","data-native-src","data-original-src","data-hi-res-src","data-low-res-src","data-raw-src","nitro-lazy-src","data-opt-src","data-orig-src","data-wpfc-original-src","data-flickity-lazyload"],normalizeDataSrcAttr:function(e){if(e){var t=this.tryGetSrcFromJson(e);return t||e}},findDeepValue:function(e,t){for(var n in e){var a=e[n];if("string"==typeof a&&t(a))return a;if("object"==typeof a)return this.findDeepValue(a,t)}},tryGetSrcFromJson:function(e){var t={};try{t=JSON.parse(e)}catch(e){return}return this.findDeepValue(t,function(e){return imageProcessor.isValidImgSrc(e)})},isValidImgSrc:function(e){return this.imgUrlRegexp.test(e)},extractFirstImageFromSrcset:function(e){try{return e.split(",")[0].trim().split(" ")[0]}catch(e){return""}},fixLazyLoadImages:function(){$doc.find("picture source[data-srcset]").each(function(){this.getAttribute("srcset")||this.setAttribute("srcset",this.getAttribute("data-srcset"))}),$doc.find("button.lightbox").each(function(){var e=DomScorerModifier.toElem(this),t=this.querySelector("img");t&&e.parent.replaceChild(DomScorerModifier.toElem(t),e)}),$doc.find('img[original],img[data-lazy-src],img[data-href],img[data-src],img[data-ezsrc],img[data-layzr],img[data-pagespeed-lazy-src],img[data-original],img[data-mediaviewer-src],img[datasrc],img[data-ct-lazy],img[data-native-src],img[data-original-src],img[data-hi-res-src],img[data-low-res-src],img[data-raw-src],img[nitro-lazy-src],img[data-opt-src],img[data-orig-src],img[data-wpfc-original-src],img[data-flickity-lazyload],img.lazyload,img.lazyloaded,img[itemprop="url"],img[loading="lazy"],img[data-load="false"],img.js-progressiveMedia-image,a[data-replace-image],amp-img').each(function(){for(var e=this,t=$(document.createElement("img")),n=null,a=0;a<imageProcessor.lazyImgDataAttributes.length;a++){var i=imageProcessor.normalizeDataSrcAttr(this.getAttribute(imageProcessor.lazyImgDataAttributes[a]));if(i&&i.indexOf(";base64,")<0){n=toAbsoluteUrl(i,pfData.config);break}}if(!(n=n||this.getAttribute("href"))&&pfData.page.location.host.match(/yahoo/)){var r=this.getAttribute("orig-style");n=r&&r.match(/(http.*?)\)/)?r.match(/(http.*?)\)/)[1]:this.getAttribute("src")}if(!n){var o=e.getAttribute("src");n=o===document.location.href?e.getAttribute("pf-orig-src"):o}pfData.config.isExtension&&n&&0===n.indexOf("//")&&(n=pfData.page.location.protocol+n);var s=e.getAttribute("pf-data-srcset")||e.getAttribute("data-srcset")||e.getAttribute("srcset");n||(n=imageProcessor.extractFirstImageFromSrcset(s)),t[0].className=e.className,copyDataset(t[0],e);var l=parseInt(e.getAttribute("width"),10),c=parseInt(e.getAttribute("height"),10);l>1&&(t[0].width=l),c>1&&(t[0].height=c),e.parentNode.replaceChild(t[0],e),t.on({load:function(){imageProcessor.layoutImages.layoutImage(t),t[0].src=t[0].src,toBase64URL(t[0].src,function(e){t[0].src=e}),t.off("load")},error:function(){var e=t.attr("src").replace(imageProcessor.interpolationUrlRegexp,"");e!==t.attr("src")&&t.attr("src",e)}}),n?t[0].src=n:s&&(t[0].srcset=s)})},layoutImages:{thresholds:{blockImage:{width:369},smallImage:{width:100,height:60}},layoutImage:function(e){if("none"===e[0].getAttribute("data-pf_style_display"))return!0;var t=this;window.setTimeout(function(){t.setImgClassAndDimensions(e)},250)},setImgClassAndDimensions:function(e){var t,n=commonUtils.getImageWidth(e,pfData.onServer),a=commonUtils.getImageHeight(e,pfData.onServer);if(0!==n&&(e.removeClass("blockImage mediumImage smallImage"),t=e.hasClass("pf-primary-img")||n>this.thresholds.blockImage.width?"blockImage":n<this.thresholds.smallImage.width&&a<this.thresholds.smallImage.height?"smallImage":"mediumImage",e.addClass(t),e.hasClass("caption-img"))){var i=e.parents(".pf-caption, .wp-caption, .caption, .tr-caption-container");e[0].offsetWidth&&1===i.find("img").length&&i.width(e[0].offsetWidth),i.addClass("pf-caption flex-width").addClass(t).addClass(imageProcessor.resizeImageCssClass),e.hasClass("thumbimage")&&e.parents(".thumbinner").width(e[0].offsetWidth).addClass("pf-caption flex-width").addClass(t).addClass(imageProcessor.resizeImageCssClass)}},setDisplayStyle:function(){var e="right",t=["left","right","block","none"],n={margin:"1em 0 1em 1.5em",clear:"right",display:"inline-block","float":"right"};-1!==$.inArray(pfData.userSettings.imageDisplayStyle,t)&&(e=pfData.userSettings.imageDisplayStyle),"block"===e?n={margin:"1em auto",clear:"both",display:"block","float":"none"}:"none"===e?(n.margin="0",n["float"]="none"):"left"===e&&(n.margin="1em 1.5em 1em 0",n["float"]="left");var a="#pf-content img.mediumImage, #pf-content figure.mediumImage {";for(var i in n)a+=i+": "+n[i]+";";a+="}",commonUtils.addCSS(a,document,!0)},init:function(){$doc.find("#pf-content img").each(function(){var e=$(this);e.hasClass("pf-svg-image")||this.removeAttribute("height"),0===commonUtils.getImageWidth(e,pfData.onServer)?(e.on("load",function(){imageProcessor.layoutImages.layoutImage(e)}),window.setTimeout(function(){imageProcessor.layoutImages.layoutImage(e)},2e3)):imageProcessor.layoutImages.layoutImage(e)})}}},helper={findNotEmptyParent:function(e){var t=e.parent();if(0!==t.length)return t.children().length>1||0!==$.trim(t.text()).length?{parent:t,tag:e}:this.findNotEmptyParent(t)},runPostAlgoProcesses:function(e){try{pfData.onServer&&nsfwChecker.checkText(e.contentTextWithTitleAndUrl),e.hasContent&&(this.addHeaderFooter(),pfData.onServer||imageProcessor.init()),messageBus.postMessage("core","PfRunPostAlgoProcesses",{contentData:e})}catch(t){exTracker.log(t),messageBus.postMessage("core","PfRunPostAlgoProcesses",{contentData:e})}},pickTitleFromContent:function(){var e=["h1","h2","h3"];$.each(e,function(e,t){var n=$doc.find(t);return 1==n.length&&""!==$.trim(n.text())?(readability.titleText=$.trim(n.text()),readability.titleTags.push(t),logger.log("Picking possible title from content - "+readability.titleText),!1):!(n.length>1)&&void 0})},isLinkTextOnly:function(e,t){var n=e.querySelectorAll("a");return 1===n.length&&n[0].innerText===t},isRecipeIngredient:function(e){var t=-1!==e.search(readability.regexps.weight),n=-1!==e.search(readability.regexps.fractions),a=-1!==e.search(readability.regexps.cookingWords);return t||n||a},addHeaderFooter:function(){var e=[];""!==$.trim(pfData.userSettings.headerImageUrl)&&e.push('<img id="pf-header-img" src="'+$.trim(pfData.userSettings.headerImageUrl)+'"/>'),""!==$.trim(pfData.userSettings.headerTagline)&&e.push('<p id="pf-tagline">'+unescape($.trim(pfData.userSettings.headerTagline))+"</p>"),pfData.config.disableUI||e.push(this.headerHtml());var t=$(".algo-author",readability.articleContent);readability.author&&0===t.length?e.push(readability.author):contentData.author="",readability.pubDate&&(e.push("<span id='pf-date'>"+readability.pubDate+"</span>"),contentData.pubDate=readability.pubDate),$(e.join("")).insertBefore($doc.find("#pf-content")),$doc.find("#pf-title").insertBefore($doc.find("#pf-src")),readability.customHeader&&($(readability.customHeader,document).insertBefore($doc.find("#pf-title")),contentData.customHeader=$(readability.customHeader).html()),readability.customFooter&&($doc.find("body").append(readability.customFooter),contentData.customFooter=$(readability.customFooter).html()),readability.copyright&&($doc.find("body").append(readability.copyright),contentData.copyright=readability.copyright.html())},headerHtml:function(){var e=pfData.config.urls.page;try{e=decodeURI(e)}catch(e){}var t=encodeURI(e),n=pfData.page.location,a=decodeURI(n.host).replace(/^www\./,""),i=decodeURI(n.pathname).replace(/\/$/,"");return'<div id="pf-src"><a id="pf-src-url" href="'+t+'"><img id="pf-src-icon" src="'+pfData.page.favicon+'" ><strong>'+a+"</strong><span>"+i+"</span></a></div>"},extractText:function(e,t){if(t.nodeType===Node.TEXT_NODE){var n=$.trim(t.nodeValue);""!==n&&e.push(n)}else if(length>1||1===t.childNodes.length&&t.childNodes[0].nodeType!=Node.TEXT_NODE)forEachNodeChild(t,function(t){helper.extractText(e,t)});else{var a=$.trim($(t).text());a.length&&e.push(a)}},findMeta:function(e,t,n){return $.grep(e,function(e){return e[t]===n})},isExclusiveBlockElement:function(e){return e.children&&1===e.children.length&&["block","flex","table-row-group","table-row"].indexOf(e.getAttribute("data-pf_style_display"))>=0},hasParentAndGrandParent:function(e,t){return e&&t&&"undefined"!==t.tagName&&"BODY"!==t.tagName&&"BODY"!==e.tagName&&"HTML"!==t.tagName},findNonExclusiveParent:function(e){for(var t=e.parentNode,n=t?t.parentNode:null;this.hasParentAndGrandParent(t,n)&&this.isExclusiveBlockElement(t);)t=n,n=n.parentNode;if("BODY"!==t.tagName&&"HTML"!==t.tagName)return t},getCommonAncestor:function(e){if(e.length<2)throw new Error("getCommonAncestor: not enough parameters");var t,n=e.shift(),a="contains"in n?"contains":"compareDocumentPosition",i="contains"===a?1:16;e:for(;n=n.parentNode;){for(t=e.length;t--;)if((n[a](e[t])&i)!==i)continue e;return n}return null}},htmlPreProcessor={run:function(e){var t;if("medium"===pfData.config.platform&&($(".js-progressiveMedia-canvas, .js-progressiveMedia-thumbnail").remove(),$(".js-progressiveMedia-image").removeClass("hidden-originally")),$("script,link,style,noscript,object,embed,.comment-list",document.body).remove(),this.replaceEmbeddedYoutube(e),$("iframe").not(".twitter-tweet-rendered").not('[src*="https://www.facebook.com/plugins/page.php"]').filter(function(){return!$(this).parent(".twitter-tweet-rendered").length}).remove(),$("iframe.twitter-tweet-rendered, .twitter-tweet-rendered iframe").each(function(){var e=$(this);this.width=e.data("pf_rect_width"),this.height=e.data("pf_rect_height")}),this.fixSvgUseTags(),pfData.onServer)t=$.Deferred().resolve();else try{this.fixCanvases();var n=this.fixInlineSvgs(e),a=this.fixSvgImages(e);t=$.when(n,a)}catch(e){logger.error(e),t=$.Deferred().reject()}return t.promise()},fixCanvases:function(){for(var e=document.getElementsByTagName("canvas"),t=pfData.page.canvasDataUrls,n=e.length-1;n>=0;n--){var a=e[n];this.convertCanvasToImage(a,t[a.getAttribute("pf-dataurl-index")])}},replaceEmbeddedYoutube:function(e){var t="https://www.youtube.com/embed/";$("iframe[src^='"+t+"']").each(function(){var n={id:null,type:null,href:null,thumb:null},a=this.src.match(new RegExp(t+"([^?]+)"));if(a){var i=a[1];n.type="video",n.href="https://youtu.be/"+i,n.thumb="https://img.youtube.com/vi/"+i+"/hqdefault.jpg"}else{var r=this.src.match(new RegExp(t+".*list=([^;&]+)"));if(r){var i=r[1];n.type="playlist",n.href="https://www.youtube.com/playlist?list="+i,n.thumb="https://img.youtube.com/vi/"+i+"/hqdefault.jpg"}}if(n.type){var o=e.tree.createElement("a");o.node.href=n.href,o.node.setAttribute("data-pf-allow-empty","1"),commonUtils.addClassTo(o.node,"youtube-replace-link");var s=e.tree.createElement("img");s.node.src=n.thumb,s.node.setAttribute("pf-restore-src",n.thumb),commonUtils.addClassTo(s.node,"youtube-replace-img");var l=e.tree.createElement("span");l.appendChild(e.tree.createTextNode(n.href)),DomScorerModifier.toElem(this.parentElement).replaceChild(o,this),o.appendChild(s),o.appendChild(l)}})},fixInlineSvgs:function(e){var t=$("svg").map(function(){return htmlPreProcessor.convertSvgToPng(e,this)});return $.when.apply($,t)},fixSvgImages:function(e){var t=/\.svg(\?.+)?$/i,n=$("img").filter(function(){return t.test(this.getAttribute("src"))}).map(function(){var t=$.Deferred();return this.onload=function(){if("pending"===t.state())try{var n=htmlPreProcessor.convertToPng(e,this);this.parentNode&&DomScorerModifier.toElem(this.parentNode).replaceChild(n,this),t.resolve()}catch(e){logger.error(e),t.reject()}},this.onerror=function(){this.parentNode&&this.parentNode.removeChild(this),t.reject()},window.setTimeout(function(){t.resolve()},2e3),t.promise()});return $.when.apply($,n)},convertToPng:function(e,t){var n=commonUtils.getImageWidth(t,pfData.onServer)||t.width,a=commonUtils.getImageHeight(t,pfData.onServer)||t.height,i=document.createElement("canvas");i.width=n,i.height=a,i.getContext("2d").drawImage(t,0,0,n,a);var r=i.toDataURL("image/png"),o=e.tree.createElement("img");o.node.width=n,o.node.height=a,o.node.src=r;var s=t.getAttribute("class");return s&&o.node.setAttribute("class",s),o},convertSvgToPng:function(e,t){var n=$.Deferred(),a=commonUtils.getSvgImageWidth(t,pfData.onServer),i=commonUtils.getSvgImageHeight(t,pfData.onServer);if(0===a||0===i)return t.parentNode.removeChild(t),n.resolve();this.fixSvgAttrs(t,a,i);var r=htmlPreProcessor.scaleImageDimensions({width:a,height:i}),o=new Image(r.width,r.height);o.onload=function(){if("pending"===n.state())try{var a=htmlPreProcessor.convertToPng(e,this),i=(t.getAttribute("class")||"")+" pf-svg-image";a.node.setAttribute("class",i),t.parentNode&&DomScorerModifier.toElem(t.parentNode).replaceChild(a,t),n.resolve()}catch(e){logger.error(e),n.reject()}},o.onerror=function(){n.reject()},window.setTimeout(function(){n.resolve()},2e3);var s=(new XMLSerializer).serializeToString(t);return o.src="data:image/svg+xml,"+encodeURIComponent(s),n.promise()},fixSvgUseTags:function(){$("svg").each(function(){var e=$(this);e.find("use").each(function(){var t=$(this),n=t.attr("xlink:href");if(!n||"#"!==n[0])return e.remove(),!1;var a=[];try{a=$(t.attr("xlink:href"))}catch(e){}if(!a.length)return e.remove(),!1;t.replaceWith(a.children().clone())})})},fixSvgAttrs:function(e,t,n){e.getAttribute("version")||e.setAttribute("version",1.1),e.getAttribute("xmlns")||e.setAttribute("xmlns","http://www.w3.org/2000/svg");try{e.setAttribute("width",t),e.setAttribute("height",n)}catch(e){}},convertCanvasToImage:function(e,t){var n,a;n=e.getAttribute("class"),n=n||"",n+=" canvas-png",a=new Image,a.src=t,a.setAttribute("class",n),e.parentNode.replaceChild(a,e)},scaleImageDimensions:function(e){if(e.width=parseInt(e.width,10),e.height=parseInt(e.height,10),e.width>pfData.config.maxImageWidth){var t=pfData.config.maxImageWidth/e.width;e.width=e.width*t,e.height=e.height*t}return e}},nsfwChecker={matchedPhrase:"",state:$.Deferred(),checkText:function(e){this.state.then(function(e){contentData.nsfwState=e,contentData.nsfwMatchedPhrase=nsfwChecker.matchedPhrase,messageBus.postMessage("core","PfNSFWChecked",{state:e,matchedPhrase:nsfwChecker.matchedPhrase})});var t=pfData.page.language||"en";t=t.split("-")[0];var n=["common","en","ar","bn","cs","da","de","eo","es","fi","fr","he","hi","hu","it","ja","ko","nl","no","pl","pt","ro","ru","sv","ta","th","tlh","tr","vi","zh"];-1!=$.inArray(t,n)?$.getJSON("/assets/client/nsfw/nsfw-7b949cfd10103ec945487e03effb74669bc584e7b07f8b2cb48eb1d7dc1b662d.json",function(n){nsfwChecker.checkContentForPhrases(e,n,t)}).fail(function(){nsfwChecker.state.resolve("unknown")}):this.state.resolve("unknown")},checkContentForPhrases:function(e,t,n){logger.time("Check for NSFW");var a="(?:^|\\s|$|\\.|,|!|\\?|\\)|\\(|\"|')";t[n]||(n="en");var i=t.common.concat(t[n]),r=new RegExp(a+"("+i.join("|")+")"+a,"i"),o=e.match(r);o?(nsfwChecker.matchedPhrase=o[0],logger.log("NSFW detected: "+nsfwChecker.matchedPhrase),this.state.resolve("present")):this.state.resolve("absent"),logger.timeEnd("Check for NSFW")}};